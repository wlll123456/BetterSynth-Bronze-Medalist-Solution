[2024-09-05 05:51:03,171] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-05 05:51:04,796] [WARNING] [runner.py:203:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-09-05 05:51:04,796] [INFO] [runner.py:570:main] cmd = /data/cjk/miniconda3/envs/dj2/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=12360 --enable_each_rank_log=None /data/cjk/project/wjc/dj_synth_challenge/toolkit/training/mgm/train/train_mem.py --deepspeed /data/cjk/project/wjc/dj_synth_challenge/toolkit/training/scripts/zero2_offload.json --model_name_or_path /data/cjk/project/wjc/dj_synth_challenge/toolkit/training/model_zoo/LLM/gemma/gemma-2b-it --version gemma --data_path /data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/mgm_instruction_stage_1.json --image_folder /data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1 --vision_tower /data/cjk/project/wjc/dj_synth_challenge/toolkit/training/model_zoo/OpenAI/clip-vit-large-patch14-336 --vision_tower_aux /data/cjk/project/wjc/dj_synth_challenge/toolkit/training/model_zoo/OpenAI/openclip-convnext-large-d-320-laion2B-s29B-b131K-ft-soup --pretrain_mm_mlp_adapter /data/cjk/project/wjc/dj_synth_challenge/toolkit/../output/training_dirs/MGM-2B-Pretrain-0904_dabao_0.5_0.9984_new_exchange_4K_X2_5/mm_projector.bin --mm_projector_type mlp2x_gelu --mm_vision_select_layer -2 --mm_use_im_start_end False --mm_use_im_patch_token False --image_aspect_ratio pad --group_by_modality_length True --image_size_aux 768 --bf16 True --num_train_epochs 1 --output_dir /data/cjk/project/wjc/dj_synth_challenge/toolkit/../output/training_dirs/MGM-2B-Finetune-0904_dabao_0.5_0.9984_new_exchange_4K_X2_5 --per_device_train_batch_size 4 --per_device_eval_batch_size 4 --gradient_accumulation_steps 8 --evaluation_strategy no --save_strategy steps --save_steps 100 --save_total_limit 1 --learning_rate 2e-5 --weight_decay 0. --warmup_ratio 0.03 --lr_scheduler_type cosine --logging_steps 50 --tf32 True --model_max_length 2048 --gradient_checkpointing True --dataloader_num_workers 4 --lazy_preprocess True --report_to none
[2024-09-05 05:51:06,467] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-05 05:51:07,859] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [4, 5, 6, 7]}
[2024-09-05 05:51:07,859] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=4, node_rank=0
[2024-09-05 05:51:07,859] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2024-09-05 05:51:07,859] [INFO] [launch.py:163:main] dist_world_size=4
[2024-09-05 05:51:07,859] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=4,5,6,7
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
[2024-09-05 05:51:09,862] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-05 05:51:09,899] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-05 05:51:09,931] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-05 05:51:09,983] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-05 05:51:12,914] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-09-05 05:51:12,915] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-09-05 05:51:12,935] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-09-05 05:51:12,935] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-09-05 05:51:13,158] [INFO] [comm.py:637:init_distributed] cdb=None
You are using a model of type gemma to instantiate a model of type mgm_gemma. This is not supported for all configurations of models and can yield errors.
You are using a model of type gemma to instantiate a model of type mgm_gemma. This is not supported for all configurations of models and can yield errors.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are using a model of type gemma to instantiate a model of type mgm_gemma. This is not supported for all configurations of models and can yield errors.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are using a model of type gemma to instantiate a model of type mgm_gemma. This is not supported for all configurations of models and can yield errors.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.24s/it]
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.38s/it]
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.37s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.42s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.69s/it]

Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.45s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.48s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.77s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.48s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.76s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.79s/it]
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading pretrained weights (convnext_large_d_320).
missing_keys: []
Loading pretrained weights (convnext_large_d_320).
Loading pretrained weights (convnext_large_d_320).
Loading pretrained weights (convnext_large_d_320).
missing_keys: []
Loading vision_tower weights...
Loading vlm_uni_query_projector weights...
Loading vlm_uni_aux_projector weights...
Loading vlm_uni_val_projector weights...
missing_keys: []
Loading vision_tower weights...
Loading vlm_uni_query_projector weights...
Loading vlm_uni_aux_projector weights...
Loading vlm_uni_val_projector weights...
missing_keys: []
Formatting inputs...Skip in lazy mode
WARNING:accelerate.utils.other:Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Loading vision_tower weights...
Loading vlm_uni_query_projector weights...
Loading vlm_uni_aux_projector weights...
Loading vlm_uni_val_projector weights...
Loading vision_tower weights...
Loading vlm_uni_query_projector weights...
Loading vlm_uni_aux_projector weights...
Loading vlm_uni_val_projector weights...
Installed CUDA version 11.8 does not match the version torch was compiled with 11.7 but since the APIs are compatible, accepting this combination
Installed CUDA version 11.8 does not match the version torch was compiled with 11.7 but since the APIs are compatible, accepting this combination
Installed CUDA version 11.8 does not match the version torch was compiled with 11.7 but since the APIs are compatible, accepting this combination
Using /home/cjk/.cache/torch_extensions/py310_cu117 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cjk/.cache/torch_extensions/py310_cu117/cpu_adam/build.ninja...
Building extension module cpu_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module cpu_adam...
Time to load cpu_adam op: 2.4072937965393066 seconds
Installed CUDA version 11.8 does not match the version torch was compiled with 11.7 but since the APIs are compatible, accepting this combination
Installed CUDA version 11.8 does not match the version torch was compiled with 11.7 but since the APIs are compatible, accepting this combination
Using /home/cjk/.cache/torch_extensions/py310_cu117 as PyTorch extensions root...
Installed CUDA version 11.8 does not match the version torch was compiled with 11.7 but since the APIs are compatible, accepting this combination
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cjk/.cache/torch_extensions/py310_cu117/cpu_adam/build.ninja...
Building extension module cpu_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module cpu_adam...
Time to load cpu_adam op: 2.4300267696380615 seconds
Installed CUDA version 11.8 does not match the version torch was compiled with 11.7 but since the APIs are compatible, accepting this combination
Using /home/cjk/.cache/torch_extensions/py310_cu117 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cjk/.cache/torch_extensions/py310_cu117/cpu_adam/build.ninja...
Building extension module cpu_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module cpu_adam...
Time to load cpu_adam op: 2.4102776050567627 seconds
Installed CUDA version 11.8 does not match the version torch was compiled with 11.7 but since the APIs are compatible, accepting this combination
Using /home/cjk/.cache/torch_extensions/py310_cu117 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cjk/.cache/torch_extensions/py310_cu117/cpu_adam/build.ninja...
Building extension module cpu_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module cpu_adam...
Time to load cpu_adam op: 2.4027280807495117 seconds
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

  0%|          | 0/1875 [00:00<?, ?it/s]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

  0%|          | 1/1875 [00:14<7:30:58, 14.44s/it]
  0%|          | 2/1875 [00:23<5:57:49, 11.46s/it]
  0%|          | 3/1875 [00:32<5:25:00, 10.42s/it]
  0%|          | 4/1875 [00:42<5:11:30,  9.99s/it]
  0%|          | 5/1875 [00:51<5:00:02,  9.63s/it]
  0%|          | 6/1875 [01:00<4:56:05,  9.51s/it]
  0%|          | 7/1875 [01:09<4:51:15,  9.36s/it]
  0%|          | 8/1875 [01:18<4:50:13,  9.33s/it]
  0%|          | 9/1875 [01:28<4:49:33,  9.31s/it]
  1%|          | 10/1875 [01:37<4:46:33,  9.22s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/PIL/Image.py:1056: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  warnings.warn(

  1%|          | 11/1875 [01:46<4:44:49,  9.17s/it]
  1%|          | 12/1875 [01:55<4:43:42,  9.14s/it]
  1%|          | 13/1875 [02:04<4:43:56,  9.15s/it]
  1%|          | 14/1875 [02:13<4:44:19,  9.17s/it]
  1%|          | 15/1875 [02:23<4:46:34,  9.24s/it]
  1%|          | 16/1875 [02:32<4:45:17,  9.21s/it]
  1%|          | 17/1875 [02:41<4:45:33,  9.22s/it]
  1%|          | 18/1875 [02:50<4:46:58,  9.27s/it]
  1%|          | 19/1875 [03:00<4:46:02,  9.25s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (2053 > 2048). Running this sequence through the model will result in indexing errors

  1%|          | 20/1875 [03:09<4:46:07,  9.25s/it]
  1%|          | 21/1875 [03:18<4:43:39,  9.18s/it]
  1%|          | 22/1875 [03:27<4:43:06,  9.17s/it]
  1%|          | 23/1875 [03:36<4:44:21,  9.21s/it]
  1%|▏         | 24/1875 [03:45<4:43:09,  9.18s/it]
  1%|▏         | 25/1875 [03:55<4:43:32,  9.20s/it]
  1%|▏         | 26/1875 [04:04<4:40:35,  9.11s/it]
  1%|▏         | 27/1875 [04:13<4:39:49,  9.09s/it]
  1%|▏         | 28/1875 [04:22<4:40:37,  9.12s/it]
  2%|▏         | 29/1875 [04:31<4:40:06,  9.10s/it]
  2%|▏         | 30/1875 [04:40<4:39:48,  9.10s/it]
  2%|▏         | 31/1875 [04:49<4:41:34,  9.16s/it]
  2%|▏         | 32/1875 [04:58<4:40:44,  9.14s/it]
  2%|▏         | 33/1875 [05:07<4:38:45,  9.08s/it]
  2%|▏         | 34/1875 [05:17<4:46:34,  9.34s/it]
  2%|▏         | 35/1875 [05:26<4:43:51,  9.26s/it]
  2%|▏         | 36/1875 [05:36<4:44:24,  9.28s/it]
  2%|▏         | 37/1875 [05:45<4:42:08,  9.21s/it]
  2%|▏         | 38/1875 [05:54<4:40:27,  9.16s/it]
  2%|▏         | 39/1875 [06:02<4:36:32,  9.04s/it]
  2%|▏         | 40/1875 [06:12<4:37:24,  9.07s/it]
  2%|▏         | 41/1875 [06:20<4:35:44,  9.02s/it]
  2%|▏         | 42/1875 [06:29<4:34:52,  9.00s/it]
  2%|▏         | 43/1875 [06:38<4:35:04,  9.01s/it]
  2%|▏         | 44/1875 [06:49<4:44:49,  9.33s/it]
  2%|▏         | 45/1875 [06:57<4:39:58,  9.18s/it]
  2%|▏         | 46/1875 [07:06<4:37:47,  9.11s/it]
  3%|▎         | 47/1875 [07:15<4:35:12,  9.03s/it]
  3%|▎         | 48/1875 [07:24<4:37:33,  9.11s/it]
  3%|▎         | 49/1875 [07:34<4:37:14,  9.11s/it]
  3%|▎         | 50/1875 [07:43<4:35:40,  9.06s/it]
                                                   
{'loss': 1.9168, 'grad_norm': 5.124883756449583, 'learning_rate': 1.754385964912281e-05, 'epoch': 0.03}

  3%|▎         | 50/1875 [07:43<4:35:40,  9.06s/it]
  3%|▎         | 51/1875 [07:52<4:36:24,  9.09s/it]
  3%|▎         | 52/1875 [08:01<4:34:42,  9.04s/it]
  3%|▎         | 53/1875 [08:10<4:35:27,  9.07s/it]
  3%|▎         | 54/1875 [08:19<4:36:43,  9.12s/it]
  3%|▎         | 55/1875 [08:28<4:36:50,  9.13s/it]
  3%|▎         | 56/1875 [08:37<4:37:14,  9.14s/it]
  3%|▎         | 57/1875 [08:46<4:36:19,  9.12s/it]
  3%|▎         | 58/1875 [08:56<4:36:36,  9.13s/it]
  3%|▎         | 59/1875 [09:05<4:35:14,  9.09s/it]
  3%|▎         | 60/1875 [09:14<4:36:36,  9.14s/it]Error in loading 176619 of [gpt4v-dataset/images/gpt_v10179.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v10179.jpg'], retrying...

  3%|▎         | 61/1875 [09:23<4:37:42,  9.19s/it]
  3%|▎         | 62/1875 [09:32<4:35:46,  9.13s/it]
  3%|▎         | 63/1875 [09:41<4:35:17,  9.12s/it]
  3%|▎         | 64/1875 [09:50<4:36:21,  9.16s/it]
  3%|▎         | 65/1875 [10:00<4:36:57,  9.18s/it]
  4%|▎         | 66/1875 [10:09<4:35:47,  9.15s/it]
  4%|▎         | 67/1875 [10:18<4:34:46,  9.12s/it]
  4%|▎         | 68/1875 [10:27<4:36:30,  9.18s/it]
  4%|▎         | 69/1875 [10:36<4:35:38,  9.16s/it]
  4%|▎         | 70/1875 [10:46<4:36:39,  9.20s/it]
  4%|▍         | 71/1875 [10:55<4:38:58,  9.28s/it]
  4%|▍         | 72/1875 [11:04<4:38:19,  9.26s/it]
  4%|▍         | 73/1875 [11:13<4:37:19,  9.23s/it]
  4%|▍         | 74/1875 [11:23<4:36:19,  9.21s/it]
  4%|▍         | 75/1875 [11:32<4:38:04,  9.27s/it]
  4%|▍         | 76/1875 [11:41<4:36:10,  9.21s/it]
  4%|▍         | 77/1875 [11:50<4:36:52,  9.24s/it]
  4%|▍         | 78/1875 [12:00<4:37:04,  9.25s/it]
  4%|▍         | 79/1875 [12:09<4:35:46,  9.21s/it]
  4%|▍         | 80/1875 [12:18<4:37:46,  9.28s/it]
  4%|▍         | 81/1875 [12:27<4:36:45,  9.26s/it]
  4%|▍         | 82/1875 [12:37<4:36:22,  9.25s/it]
  4%|▍         | 83/1875 [12:46<4:33:57,  9.17s/it]
  4%|▍         | 84/1875 [12:55<4:33:19,  9.16s/it]
  5%|▍         | 85/1875 [13:04<4:30:21,  9.06s/it]
  5%|▍         | 86/1875 [13:12<4:28:43,  9.01s/it]
  5%|▍         | 87/1875 [13:22<4:29:33,  9.05s/it]
  5%|▍         | 88/1875 [13:31<4:28:44,  9.02s/it]
  5%|▍         | 89/1875 [13:40<4:28:14,  9.01s/it]
  5%|▍         | 90/1875 [13:49<4:29:31,  9.06s/it]Error in loading 5913 of [gpt4v-dataset/images/gpt_v11084.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v11084.jpg'], retrying...
Error in loading 151773 of [gpt4v-dataset/images/gpt_v4150.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v4150.jpg'], retrying...

  5%|▍         | 91/1875 [13:58<4:30:16,  9.09s/it]
  5%|▍         | 92/1875 [14:07<4:28:47,  9.04s/it]
  5%|▍         | 93/1875 [14:16<4:29:54,  9.09s/it]Error in loading 185352 of [gpt4v-dataset/images/gpt_v10371.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v10371.jpg'], retrying...

  5%|▌         | 94/1875 [14:25<4:30:13,  9.10s/it]
  5%|▌         | 95/1875 [14:34<4:31:38,  9.16s/it]
  5%|▌         | 96/1875 [14:43<4:30:01,  9.11s/it]
  5%|▌         | 97/1875 [14:53<4:31:33,  9.16s/it]
  5%|▌         | 98/1875 [15:02<4:29:24,  9.10s/it]
  5%|▌         | 99/1875 [15:11<4:28:04,  9.06s/it]
  5%|▌         | 100/1875 [15:20<4:29:13,  9.10s/it]
                                                    
{'loss': 1.5006, 'grad_norm': 3.6901487993460607, 'learning_rate': 1.997240571992685e-05, 'epoch': 0.05}

  5%|▌         | 100/1875 [15:20<4:29:13,  9.10s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

  5%|▌         | 101/1875 [15:57<8:42:00, 17.66s/it]
  5%|▌         | 102/1875 [16:07<7:25:57, 15.09s/it]
  5%|▌         | 103/1875 [16:16<6:32:54, 13.30s/it]
  6%|▌         | 104/1875 [16:25<5:56:22, 12.07s/it]Error in loading 171100 of [gpt4v-dataset/images/gpt_v5753.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v5753.jpg'], retrying...

  6%|▌         | 105/1875 [16:34<5:27:31, 11.10s/it]
  6%|▌         | 106/1875 [16:43<5:07:12, 10.42s/it]
  6%|▌         | 107/1875 [16:51<4:54:14,  9.99s/it]
  6%|▌         | 108/1875 [17:00<4:44:56,  9.68s/it]
  6%|▌         | 109/1875 [17:09<4:39:13,  9.49s/it]
  6%|▌         | 110/1875 [17:19<4:35:55,  9.38s/it]
  6%|▌         | 111/1875 [17:27<4:29:48,  9.18s/it]
  6%|▌         | 112/1875 [17:36<4:27:05,  9.09s/it]
  6%|▌         | 113/1875 [17:45<4:25:13,  9.03s/it]
  6%|▌         | 114/1875 [17:54<4:25:57,  9.06s/it]
  6%|▌         | 115/1875 [18:03<4:26:08,  9.07s/it]
  6%|▌         | 116/1875 [18:12<4:24:40,  9.03s/it]
  6%|▌         | 117/1875 [18:21<4:23:18,  8.99s/it]
  6%|▋         | 118/1875 [18:30<4:23:20,  8.99s/it]
  6%|▋         | 119/1875 [18:39<4:23:59,  9.02s/it]
  6%|▋         | 120/1875 [18:48<4:24:21,  9.04s/it]
  6%|▋         | 121/1875 [18:58<4:25:38,  9.09s/it]Error in loading 228577 of [gpt4v-dataset/images/gpt_v5445.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v5445.jpg'], retrying...

  7%|▋         | 122/1875 [19:06<4:23:23,  9.02s/it]
  7%|▋         | 123/1875 [19:15<4:21:41,  8.96s/it]
  7%|▋         | 124/1875 [19:25<4:26:02,  9.12s/it]
  7%|▋         | 125/1875 [19:34<4:25:19,  9.10s/it]
  7%|▋         | 126/1875 [19:43<4:26:50,  9.15s/it]
  7%|▋         | 127/1875 [19:52<4:25:55,  9.13s/it]
  7%|▋         | 128/1875 [20:01<4:22:20,  9.01s/it]
  7%|▋         | 129/1875 [20:10<4:22:57,  9.04s/it]
  7%|▋         | 130/1875 [20:19<4:23:44,  9.07s/it]
  7%|▋         | 131/1875 [20:28<4:23:39,  9.07s/it]
  7%|▋         | 132/1875 [20:37<4:21:53,  9.02s/it]
  7%|▋         | 133/1875 [20:46<4:19:21,  8.93s/it]
  7%|▋         | 134/1875 [20:55<4:20:38,  8.98s/it]
  7%|▋         | 135/1875 [21:04<4:21:42,  9.02s/it]
  7%|▋         | 136/1875 [21:13<4:20:44,  9.00s/it]
  7%|▋         | 137/1875 [21:23<4:26:49,  9.21s/it]
  7%|▋         | 138/1875 [21:31<4:23:28,  9.10s/it]
  7%|▋         | 139/1875 [21:40<4:21:46,  9.05s/it]
  7%|▋         | 140/1875 [21:50<4:22:26,  9.08s/it]
  8%|▊         | 141/1875 [21:59<4:21:53,  9.06s/it]
  8%|▊         | 142/1875 [22:08<4:22:20,  9.08s/it]
  8%|▊         | 143/1875 [22:17<4:20:33,  9.03s/it]
  8%|▊         | 144/1875 [22:25<4:16:57,  8.91s/it]
  8%|▊         | 145/1875 [22:34<4:16:03,  8.88s/it]
  8%|▊         | 146/1875 [22:43<4:16:28,  8.90s/it]
  8%|▊         | 147/1875 [22:52<4:19:50,  9.02s/it]
  8%|▊         | 148/1875 [23:01<4:20:12,  9.04s/it]
  8%|▊         | 149/1875 [23:11<4:21:31,  9.09s/it]
  8%|▊         | 150/1875 [23:20<4:22:03,  9.12s/it]
                                                    
{'loss': 1.4671, 'grad_norm': 2.9807390125085202, 'learning_rate': 1.9871141530411854e-05, 'epoch': 0.08}

  8%|▊         | 150/1875 [23:20<4:22:03,  9.12s/it]
  8%|▊         | 151/1875 [23:29<4:19:59,  9.05s/it]
  8%|▊         | 152/1875 [23:38<4:21:46,  9.12s/it]
  8%|▊         | 153/1875 [23:47<4:21:59,  9.13s/it]
  8%|▊         | 154/1875 [23:56<4:20:51,  9.09s/it]
  8%|▊         | 155/1875 [24:05<4:19:02,  9.04s/it]
  8%|▊         | 156/1875 [24:14<4:17:38,  8.99s/it]
  8%|▊         | 157/1875 [24:23<4:15:56,  8.94s/it]
  8%|▊         | 158/1875 [24:32<4:16:48,  8.97s/it]
  8%|▊         | 159/1875 [24:41<4:16:36,  8.97s/it]
  9%|▊         | 160/1875 [24:50<4:15:06,  8.92s/it]
  9%|▊         | 161/1875 [24:59<4:15:30,  8.94s/it]
  9%|▊         | 162/1875 [25:08<4:17:14,  9.01s/it]
  9%|▊         | 163/1875 [25:17<4:15:51,  8.97s/it]
  9%|▊         | 164/1875 [25:26<4:16:42,  9.00s/it]
  9%|▉         | 165/1875 [25:34<4:14:59,  8.95s/it]
  9%|▉         | 166/1875 [25:43<4:13:45,  8.91s/it]
  9%|▉         | 167/1875 [25:52<4:14:46,  8.95s/it]
  9%|▉         | 168/1875 [26:01<4:14:47,  8.96s/it]
  9%|▉         | 169/1875 [26:10<4:15:09,  8.97s/it]
  9%|▉         | 170/1875 [26:19<4:14:19,  8.95s/it]
  9%|▉         | 171/1875 [26:28<4:14:16,  8.95s/it]
  9%|▉         | 172/1875 [26:37<4:15:08,  8.99s/it]
  9%|▉         | 173/1875 [26:46<4:16:51,  9.05s/it]
  9%|▉         | 174/1875 [26:55<4:15:28,  9.01s/it]
  9%|▉         | 175/1875 [27:04<4:14:12,  8.97s/it]
  9%|▉         | 176/1875 [27:13<4:12:28,  8.92s/it]
  9%|▉         | 177/1875 [27:23<4:18:51,  9.15s/it]
  9%|▉         | 178/1875 [27:32<4:19:34,  9.18s/it]
 10%|▉         | 179/1875 [27:41<4:18:52,  9.16s/it]
 10%|▉         | 180/1875 [27:50<4:15:59,  9.06s/it]
 10%|▉         | 181/1875 [27:59<4:16:02,  9.07s/it]
 10%|▉         | 182/1875 [28:08<4:14:59,  9.04s/it]
 10%|▉         | 183/1875 [28:17<4:14:54,  9.04s/it]
 10%|▉         | 184/1875 [28:26<4:15:09,  9.05s/it]
 10%|▉         | 185/1875 [28:35<4:15:48,  9.08s/it]
 10%|▉         | 186/1875 [28:44<4:13:49,  9.02s/it]
 10%|▉         | 187/1875 [28:53<4:11:57,  8.96s/it]
 10%|█         | 188/1875 [29:02<4:16:36,  9.13s/it]
 10%|█         | 189/1875 [29:12<4:17:11,  9.15s/it]
 10%|█         | 190/1875 [29:21<4:16:02,  9.12s/it]
 10%|█         | 191/1875 [29:30<4:13:54,  9.05s/it]
 10%|█         | 192/1875 [29:38<4:10:41,  8.94s/it]
 10%|█         | 193/1875 [29:47<4:10:54,  8.95s/it]
 10%|█         | 194/1875 [29:56<4:12:40,  9.02s/it]
 10%|█         | 195/1875 [30:06<4:13:38,  9.06s/it]Error in loading 220878 of [gpt4v-dataset/images/gpt_v7747.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v7747.jpg'], retrying...

 10%|█         | 196/1875 [30:15<4:13:32,  9.06s/it]
 11%|█         | 197/1875 [30:24<4:14:10,  9.09s/it]
 11%|█         | 198/1875 [30:33<4:15:38,  9.15s/it]
 11%|█         | 199/1875 [30:42<4:14:34,  9.11s/it]
 11%|█         | 200/1875 [30:51<4:15:18,  9.15s/it]
                                                    
{'loss': 1.4296, 'grad_norm': 3.7950470123209907, 'learning_rate': 1.9696231338608317e-05, 'epoch': 0.11}

 11%|█         | 200/1875 [30:51<4:15:18,  9.15s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 11%|█         | 201/1875 [31:27<7:57:41, 17.12s/it]
 11%|█         | 202/1875 [31:36<6:51:00, 14.74s/it]
 11%|█         | 203/1875 [31:46<6:07:06, 13.17s/it]
 11%|█         | 204/1875 [31:55<5:32:57, 11.96s/it]
 11%|█         | 205/1875 [32:04<5:08:18, 11.08s/it]
 11%|█         | 206/1875 [32:13<4:53:37, 10.56s/it]
 11%|█         | 207/1875 [32:22<4:41:45, 10.14s/it]
 11%|█         | 208/1875 [32:31<4:32:49,  9.82s/it]
 11%|█         | 209/1875 [32:41<4:27:15,  9.63s/it]
 11%|█         | 210/1875 [32:50<4:28:39,  9.68s/it]
 11%|█▏        | 211/1875 [33:01<4:31:50,  9.80s/it]
 11%|█▏        | 212/1875 [33:09<4:24:35,  9.55s/it]
 11%|█▏        | 213/1875 [33:19<4:21:25,  9.44s/it]
 11%|█▏        | 214/1875 [33:28<4:17:35,  9.30s/it]
 11%|█▏        | 215/1875 [33:36<4:12:20,  9.12s/it]
 12%|█▏        | 216/1875 [33:45<4:11:21,  9.09s/it]
 12%|█▏        | 217/1875 [33:54<4:08:33,  9.00s/it]
 12%|█▏        | 218/1875 [34:03<4:08:04,  8.98s/it]
 12%|█▏        | 219/1875 [34:12<4:08:07,  8.99s/it]
 12%|█▏        | 220/1875 [34:21<4:07:57,  8.99s/it]
 12%|█▏        | 221/1875 [34:30<4:07:15,  8.97s/it]
 12%|█▏        | 222/1875 [34:39<4:07:05,  8.97s/it]
 12%|█▏        | 223/1875 [34:48<4:10:39,  9.10s/it]
 12%|█▏        | 224/1875 [34:57<4:08:58,  9.05s/it]
 12%|█▏        | 225/1875 [35:06<4:07:36,  9.00s/it]
 12%|█▏        | 226/1875 [35:15<4:07:30,  9.01s/it]
 12%|█▏        | 227/1875 [35:25<4:12:39,  9.20s/it]
 12%|█▏        | 228/1875 [35:34<4:10:57,  9.14s/it]
 12%|█▏        | 229/1875 [35:43<4:13:25,  9.24s/it]
 12%|█▏        | 230/1875 [35:52<4:11:32,  9.17s/it]
 12%|█▏        | 231/1875 [36:02<4:12:46,  9.23s/it]
 12%|█▏        | 232/1875 [36:11<4:10:21,  9.14s/it]
 12%|█▏        | 233/1875 [36:20<4:10:27,  9.15s/it]
 12%|█▏        | 234/1875 [36:29<4:11:18,  9.19s/it]Error in loading 87205 of [gpt4v-dataset/images/gpt_v4495.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v4495.jpg'], retrying...

 13%|█▎        | 235/1875 [36:39<4:15:03,  9.33s/it]
 13%|█▎        | 236/1875 [36:47<4:09:27,  9.13s/it]
 13%|█▎        | 237/1875 [36:57<4:09:06,  9.13s/it]
 13%|█▎        | 238/1875 [37:05<4:07:08,  9.06s/it]
 13%|█▎        | 239/1875 [37:14<4:04:52,  8.98s/it]
 13%|█▎        | 240/1875 [37:24<4:06:51,  9.06s/it]
 13%|█▎        | 241/1875 [37:37<4:43:27, 10.41s/it]
 13%|█▎        | 242/1875 [37:46<4:33:10, 10.04s/it]
 13%|█▎        | 243/1875 [37:55<4:23:18,  9.68s/it]
 13%|█▎        | 244/1875 [38:04<4:17:01,  9.46s/it]
 13%|█▎        | 245/1875 [38:13<4:12:03,  9.28s/it]
 13%|█▎        | 246/1875 [38:22<4:09:17,  9.18s/it]
 13%|█▎        | 247/1875 [38:31<4:09:17,  9.19s/it]
 13%|█▎        | 248/1875 [38:40<4:06:30,  9.09s/it]
 13%|█▎        | 249/1875 [38:49<4:04:52,  9.04s/it]
 13%|█▎        | 250/1875 [38:58<4:05:02,  9.05s/it]
                                                    
{'loss': 1.3917, 'grad_norm': 3.151950436475543, 'learning_rate': 1.9448980103658613e-05, 'epoch': 0.13}

 13%|█▎        | 250/1875 [38:58<4:05:02,  9.05s/it]
 13%|█▎        | 251/1875 [39:07<4:04:34,  9.04s/it]
 13%|█▎        | 252/1875 [39:16<4:03:41,  9.01s/it]
 13%|█▎        | 253/1875 [39:25<4:02:22,  8.97s/it]
 14%|█▎        | 254/1875 [39:34<4:02:50,  8.99s/it]
 14%|█▎        | 255/1875 [39:43<4:03:11,  9.01s/it]
 14%|█▎        | 256/1875 [39:52<4:00:48,  8.92s/it]
 14%|█▎        | 257/1875 [40:01<4:01:25,  8.95s/it]
 14%|█▍        | 258/1875 [40:09<4:01:07,  8.95s/it]
 14%|█▍        | 259/1875 [40:19<4:02:38,  9.01s/it]
 14%|█▍        | 260/1875 [40:28<4:07:17,  9.19s/it]
 14%|█▍        | 261/1875 [40:37<4:06:47,  9.17s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (2328 > 2048). Running this sequence through the model will result in indexing errors

 14%|█▍        | 262/1875 [40:46<4:04:56,  9.11s/it]
 14%|█▍        | 263/1875 [40:56<4:05:40,  9.14s/it]Error in loading 5550 of [gpt4v-dataset/images/gpt_v8519.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v8519.jpg'], retrying...

 14%|█▍        | 264/1875 [41:05<4:10:14,  9.32s/it]
 14%|█▍        | 265/1875 [41:14<4:07:29,  9.22s/it]
 14%|█▍        | 266/1875 [41:23<4:04:51,  9.13s/it]
 14%|█▍        | 267/1875 [41:32<4:02:28,  9.05s/it]
 14%|█▍        | 268/1875 [41:42<4:07:10,  9.23s/it]
 14%|█▍        | 269/1875 [41:51<4:06:00,  9.19s/it]
 14%|█▍        | 270/1875 [42:00<4:02:57,  9.08s/it]
 14%|█▍        | 271/1875 [42:09<4:03:41,  9.12s/it]
 15%|█▍        | 272/1875 [42:18<4:04:37,  9.16s/it]
 15%|█▍        | 273/1875 [42:27<4:02:04,  9.07s/it]
 15%|█▍        | 274/1875 [42:36<4:04:14,  9.15s/it]
 15%|█▍        | 275/1875 [42:45<4:03:21,  9.13s/it]
 15%|█▍        | 276/1875 [42:54<4:02:11,  9.09s/it]
 15%|█▍        | 277/1875 [43:03<4:02:08,  9.09s/it]
 15%|█▍        | 278/1875 [43:12<3:59:33,  9.00s/it]
 15%|█▍        | 279/1875 [43:21<3:59:42,  9.01s/it]
 15%|█▍        | 280/1875 [43:31<4:01:34,  9.09s/it]
 15%|█▍        | 281/1875 [43:39<4:00:02,  9.04s/it]Error in loading 150327 of [gpt4v-dataset/images/gpt_v5432.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v5432.jpg'], retrying...

 15%|█▌        | 282/1875 [43:49<4:01:33,  9.10s/it]
 15%|█▌        | 283/1875 [43:58<4:00:18,  9.06s/it]
 15%|█▌        | 284/1875 [44:07<3:59:28,  9.03s/it]
 15%|█▌        | 285/1875 [44:16<4:04:39,  9.23s/it]Error in loading 17655 of [gpt4v-dataset/images/gpt_v7456.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v7456.jpg'], retrying...

 15%|█▌        | 286/1875 [44:25<4:01:09,  9.11s/it]
 15%|█▌        | 287/1875 [44:34<3:59:45,  9.06s/it]
 15%|█▌        | 288/1875 [44:43<3:59:54,  9.07s/it]
 15%|█▌        | 289/1875 [44:52<3:57:32,  8.99s/it]
 15%|█▌        | 290/1875 [45:01<3:58:48,  9.04s/it]
 16%|█▌        | 291/1875 [45:10<3:58:28,  9.03s/it]
 16%|█▌        | 292/1875 [45:19<3:57:43,  9.01s/it]
 16%|█▌        | 293/1875 [45:28<3:56:36,  8.97s/it]
 16%|█▌        | 294/1875 [45:37<3:54:56,  8.92s/it]
 16%|█▌        | 295/1875 [45:47<4:01:49,  9.18s/it]
 16%|█▌        | 296/1875 [45:56<4:00:48,  9.15s/it]
 16%|█▌        | 297/1875 [46:05<4:00:02,  9.13s/it]
 16%|█▌        | 298/1875 [46:14<3:59:07,  9.10s/it]
 16%|█▌        | 299/1875 [46:23<3:56:44,  9.01s/it]
 16%|█▌        | 300/1875 [46:32<3:55:44,  8.98s/it]
                                                    
{'loss': 1.3898, 'grad_norm': 2.8952731154186737, 'learning_rate': 1.913123250228619e-05, 'epoch': 0.16}

 16%|█▌        | 300/1875 [46:32<3:55:44,  8.98s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 16%|█▌        | 301/1875 [47:14<8:20:22, 19.07s/it]
 16%|█▌        | 302/1875 [47:23<7:00:47, 16.05s/it]
 16%|█▌        | 303/1875 [47:32<6:06:00, 13.97s/it]
 16%|█▌        | 304/1875 [47:41<5:27:37, 12.51s/it]
 16%|█▋        | 305/1875 [47:50<5:00:51, 11.50s/it]
 16%|█▋        | 306/1875 [47:59<4:38:42, 10.66s/it]
 16%|█▋        | 307/1875 [48:08<4:25:23, 10.16s/it]
 16%|█▋        | 308/1875 [48:17<4:16:37,  9.83s/it]
 16%|█▋        | 309/1875 [48:26<4:09:34,  9.56s/it]
 17%|█▋        | 310/1875 [48:35<4:05:12,  9.40s/it]
 17%|█▋        | 311/1875 [48:44<4:01:21,  9.26s/it]
 17%|█▋        | 312/1875 [48:53<3:59:41,  9.20s/it]
 17%|█▋        | 313/1875 [49:02<3:58:28,  9.16s/it]
 17%|█▋        | 314/1875 [49:11<3:57:37,  9.13s/it]
 17%|█▋        | 315/1875 [49:21<3:58:43,  9.18s/it]
 17%|█▋        | 316/1875 [49:29<3:56:07,  9.09s/it]
 17%|█▋        | 317/1875 [49:38<3:54:32,  9.03s/it]
 17%|█▋        | 318/1875 [49:47<3:52:05,  8.94s/it]
 17%|█▋        | 319/1875 [49:56<3:51:23,  8.92s/it]
 17%|█▋        | 320/1875 [50:05<3:52:54,  8.99s/it]
 17%|█▋        | 321/1875 [50:14<3:53:42,  9.02s/it]
 17%|█▋        | 322/1875 [50:23<3:53:12,  9.01s/it]
 17%|█▋        | 323/1875 [50:32<3:52:30,  8.99s/it]
 17%|█▋        | 324/1875 [50:41<3:50:56,  8.93s/it]
 17%|█▋        | 325/1875 [50:50<3:52:05,  8.98s/it]
 17%|█▋        | 326/1875 [50:59<3:52:05,  8.99s/it]
 17%|█▋        | 327/1875 [51:08<3:53:57,  9.07s/it]
 17%|█▋        | 328/1875 [51:17<3:52:49,  9.03s/it]
 18%|█▊        | 329/1875 [51:27<3:56:52,  9.19s/it]
 18%|█▊        | 330/1875 [51:36<3:56:30,  9.19s/it]
 18%|█▊        | 331/1875 [51:45<3:56:37,  9.20s/it]
 18%|█▊        | 332/1875 [51:55<3:58:51,  9.29s/it]
 18%|█▊        | 333/1875 [52:04<3:57:20,  9.23s/it]
 18%|█▊        | 334/1875 [52:13<3:54:22,  9.13s/it]
 18%|█▊        | 335/1875 [52:22<3:51:40,  9.03s/it]
 18%|█▊        | 336/1875 [52:30<3:51:00,  9.01s/it]
 18%|█▊        | 337/1875 [52:40<3:51:04,  9.01s/it]
 18%|█▊        | 338/1875 [52:49<3:51:37,  9.04s/it]
 18%|█▊        | 339/1875 [52:57<3:49:53,  8.98s/it]
 18%|█▊        | 340/1875 [53:06<3:48:00,  8.91s/it]
 18%|█▊        | 341/1875 [53:15<3:49:10,  8.96s/it]
 18%|█▊        | 342/1875 [53:24<3:49:44,  8.99s/it]
 18%|█▊        | 343/1875 [53:33<3:49:51,  9.00s/it]
 18%|█▊        | 344/1875 [53:42<3:49:35,  9.00s/it]
 18%|█▊        | 345/1875 [53:51<3:49:25,  9.00s/it]
 18%|█▊        | 346/1875 [54:01<3:51:06,  9.07s/it]
 19%|█▊        | 347/1875 [54:10<3:51:38,  9.10s/it]
 19%|█▊        | 348/1875 [54:19<3:51:56,  9.11s/it]
 19%|█▊        | 349/1875 [54:28<3:50:56,  9.08s/it]
 19%|█▊        | 350/1875 [54:37<3:49:57,  9.05s/it]
                                                    
{'loss': 1.3762, 'grad_norm': 2.8056463766486637, 'learning_rate': 1.8745359166145526e-05, 'epoch': 0.19}

 19%|█▊        | 350/1875 [54:37<3:49:57,  9.05s/it]
 19%|█▊        | 351/1875 [54:46<3:49:02,  9.02s/it]
 19%|█▉        | 352/1875 [54:55<3:50:54,  9.10s/it]
 19%|█▉        | 353/1875 [55:04<3:50:47,  9.10s/it]
 19%|█▉        | 354/1875 [55:13<3:50:44,  9.10s/it]
 19%|█▉        | 355/1875 [55:22<3:49:31,  9.06s/it]
 19%|█▉        | 356/1875 [55:31<3:50:09,  9.09s/it]
 19%|█▉        | 357/1875 [55:40<3:49:10,  9.06s/it]
 19%|█▉        | 358/1875 [55:50<3:49:14,  9.07s/it]
 19%|█▉        | 359/1875 [55:58<3:46:28,  8.96s/it]
 19%|█▉        | 360/1875 [56:07<3:45:02,  8.91s/it]
 19%|█▉        | 361/1875 [56:16<3:44:58,  8.92s/it]
 19%|█▉        | 362/1875 [56:25<3:44:29,  8.90s/it]
 19%|█▉        | 363/1875 [56:34<3:43:32,  8.87s/it]
 19%|█▉        | 364/1875 [56:43<3:43:36,  8.88s/it]
 19%|█▉        | 365/1875 [56:51<3:42:53,  8.86s/it]
 20%|█▉        | 366/1875 [57:00<3:42:10,  8.83s/it]
 20%|█▉        | 367/1875 [57:09<3:42:34,  8.86s/it]
 20%|█▉        | 368/1875 [57:18<3:44:45,  8.95s/it]
 20%|█▉        | 369/1875 [57:27<3:43:06,  8.89s/it]Error in loading 32798 of [gpt4v-dataset/images/gpt_v8771.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v8771.jpg'], retrying...

 20%|█▉        | 370/1875 [57:36<3:47:07,  9.05s/it]
 20%|█▉        | 371/1875 [57:45<3:44:19,  8.95s/it]
 20%|█▉        | 372/1875 [57:54<3:44:04,  8.95s/it]
 20%|█▉        | 373/1875 [58:03<3:43:58,  8.95s/it]
 20%|█▉        | 374/1875 [58:12<3:42:55,  8.91s/it]
 20%|██        | 375/1875 [58:21<3:42:25,  8.90s/it]
 20%|██        | 376/1875 [58:30<3:42:55,  8.92s/it]
 20%|██        | 377/1875 [58:39<3:43:24,  8.95s/it]
 20%|██        | 378/1875 [58:48<3:43:22,  8.95s/it]
 20%|██        | 379/1875 [58:57<3:43:25,  8.96s/it]
 20%|██        | 380/1875 [59:06<3:43:40,  8.98s/it]
 20%|██        | 381/1875 [59:14<3:42:57,  8.95s/it]
 20%|██        | 382/1875 [59:24<3:45:00,  9.04s/it]
 20%|██        | 383/1875 [59:33<3:45:05,  9.05s/it]
 20%|██        | 384/1875 [59:42<3:44:48,  9.05s/it]
 21%|██        | 385/1875 [59:51<3:42:18,  8.95s/it]
 21%|██        | 386/1875 [59:59<3:41:21,  8.92s/it]
 21%|██        | 387/1875 [1:00:08<3:41:10,  8.92s/it]
 21%|██        | 388/1875 [1:00:18<3:43:30,  9.02s/it]
 21%|██        | 389/1875 [1:00:27<3:44:58,  9.08s/it]
 21%|██        | 390/1875 [1:00:36<3:46:32,  9.15s/it]
 21%|██        | 391/1875 [1:00:45<3:44:06,  9.06s/it]
 21%|██        | 392/1875 [1:00:54<3:45:11,  9.11s/it]
 21%|██        | 393/1875 [1:01:03<3:43:10,  9.04s/it]
 21%|██        | 394/1875 [1:01:12<3:43:04,  9.04s/it]
 21%|██        | 395/1875 [1:01:21<3:42:38,  9.03s/it]
 21%|██        | 396/1875 [1:01:30<3:41:56,  9.00s/it]
 21%|██        | 397/1875 [1:01:39<3:44:53,  9.13s/it]
 21%|██        | 398/1875 [1:01:49<3:45:09,  9.15s/it]
 21%|██▏       | 399/1875 [1:01:58<3:45:06,  9.15s/it]
 21%|██▏       | 400/1875 [1:02:07<3:48:03,  9.28s/it]
                                                      
{'loss': 1.35, 'grad_norm': 2.885680707286288, 'learning_rate': 1.8294238995160093e-05, 'epoch': 0.21}

 21%|██▏       | 400/1875 [1:02:07<3:48:03,  9.28s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 21%|██▏       | 401/1875 [1:02:42<6:52:55, 16.81s/it]
 21%|██▏       | 402/1875 [1:02:51<5:55:09, 14.47s/it]
 21%|██▏       | 403/1875 [1:03:00<5:15:20, 12.85s/it]
 22%|██▏       | 404/1875 [1:03:09<4:45:55, 11.66s/it]
 22%|██▏       | 405/1875 [1:03:18<4:24:45, 10.81s/it]
 22%|██▏       | 406/1875 [1:03:27<4:12:20, 10.31s/it]
 22%|██▏       | 407/1875 [1:03:36<4:02:58,  9.93s/it]
 22%|██▏       | 408/1875 [1:03:45<3:57:07,  9.70s/it]
 22%|██▏       | 409/1875 [1:03:54<3:50:39,  9.44s/it]
 22%|██▏       | 410/1875 [1:04:03<3:46:28,  9.28s/it]
 22%|██▏       | 411/1875 [1:04:12<3:45:30,  9.24s/it]
 22%|██▏       | 412/1875 [1:04:21<3:43:10,  9.15s/it]
 22%|██▏       | 413/1875 [1:04:30<3:41:19,  9.08s/it]
 22%|██▏       | 414/1875 [1:04:39<3:40:09,  9.04s/it]
 22%|██▏       | 415/1875 [1:04:47<3:38:40,  8.99s/it]
 22%|██▏       | 416/1875 [1:04:56<3:37:56,  8.96s/it]
 22%|██▏       | 417/1875 [1:05:06<3:38:54,  9.01s/it]
 22%|██▏       | 418/1875 [1:05:15<3:40:46,  9.09s/it]
 22%|██▏       | 419/1875 [1:05:24<3:38:07,  8.99s/it]
 22%|██▏       | 420/1875 [1:05:32<3:37:10,  8.96s/it]
 22%|██▏       | 421/1875 [1:05:41<3:36:31,  8.93s/it]
 23%|██▎       | 422/1875 [1:05:50<3:34:23,  8.85s/it]
 23%|██▎       | 423/1875 [1:05:59<3:37:56,  9.01s/it]
 23%|██▎       | 424/1875 [1:06:08<3:35:38,  8.92s/it]
 23%|██▎       | 425/1875 [1:06:17<3:37:02,  8.98s/it]
 23%|██▎       | 426/1875 [1:06:26<3:36:18,  8.96s/it]
 23%|██▎       | 427/1875 [1:06:35<3:34:05,  8.87s/it]
 23%|██▎       | 428/1875 [1:06:44<3:34:13,  8.88s/it]
 23%|██▎       | 429/1875 [1:06:53<3:35:09,  8.93s/it]
 23%|██▎       | 430/1875 [1:07:01<3:33:37,  8.87s/it]
 23%|██▎       | 431/1875 [1:07:10<3:33:04,  8.85s/it]
 23%|██▎       | 432/1875 [1:07:19<3:34:37,  8.92s/it]
 23%|██▎       | 433/1875 [1:07:28<3:32:57,  8.86s/it]
 23%|██▎       | 434/1875 [1:07:37<3:33:37,  8.89s/it]
 23%|██▎       | 435/1875 [1:07:46<3:35:14,  8.97s/it]
 23%|██▎       | 436/1875 [1:07:55<3:34:42,  8.95s/it]
 23%|██▎       | 437/1875 [1:08:04<3:33:43,  8.92s/it]
 23%|██▎       | 438/1875 [1:08:13<3:35:29,  9.00s/it]
 23%|██▎       | 439/1875 [1:08:22<3:34:36,  8.97s/it]
 23%|██▎       | 440/1875 [1:08:31<3:35:08,  9.00s/it]
 24%|██▎       | 441/1875 [1:08:40<3:34:15,  8.96s/it]
 24%|██▎       | 442/1875 [1:08:49<3:33:23,  8.93s/it]
 24%|██▎       | 443/1875 [1:08:57<3:31:04,  8.84s/it]
 24%|██▎       | 444/1875 [1:09:06<3:30:01,  8.81s/it]
 24%|██▎       | 445/1875 [1:09:15<3:30:55,  8.85s/it]
 24%|██▍       | 446/1875 [1:09:24<3:32:21,  8.92s/it]
 24%|██▍       | 447/1875 [1:09:33<3:30:55,  8.86s/it]
 24%|██▍       | 448/1875 [1:09:42<3:30:57,  8.87s/it]
 24%|██▍       | 449/1875 [1:09:51<3:30:00,  8.84s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/PIL/Image.py:1056: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  warnings.warn(

 24%|██▍       | 450/1875 [1:09:59<3:29:21,  8.82s/it]
                                                      
{'loss': 1.3587, 'grad_norm': 5.211244921680933, 'learning_rate': 1.7781237678803845e-05, 'epoch': 0.24}

 24%|██▍       | 450/1875 [1:09:59<3:29:21,  8.82s/it]
 24%|██▍       | 451/1875 [1:10:09<3:32:38,  8.96s/it]
 24%|██▍       | 452/1875 [1:10:18<3:34:33,  9.05s/it]
 24%|██▍       | 453/1875 [1:10:27<3:35:29,  9.09s/it]
 24%|██▍       | 454/1875 [1:10:36<3:34:01,  9.04s/it]
 24%|██▍       | 455/1875 [1:10:46<3:37:48,  9.20s/it]
 24%|██▍       | 456/1875 [1:10:55<3:40:23,  9.32s/it]
 24%|██▍       | 457/1875 [1:11:05<3:44:41,  9.51s/it]
 24%|██▍       | 458/1875 [1:11:15<3:46:16,  9.58s/it]
 24%|██▍       | 459/1875 [1:11:24<3:41:42,  9.39s/it]
 25%|██▍       | 460/1875 [1:11:34<3:45:45,  9.57s/it]
 25%|██▍       | 461/1875 [1:11:45<3:54:37,  9.96s/it]
 25%|██▍       | 462/1875 [1:11:54<3:51:42,  9.84s/it]
 25%|██▍       | 463/1875 [1:12:03<3:46:53,  9.64s/it]
 25%|██▍       | 464/1875 [1:12:13<3:43:36,  9.51s/it]
 25%|██▍       | 465/1875 [1:12:22<3:43:52,  9.53s/it]
 25%|██▍       | 466/1875 [1:12:31<3:39:11,  9.33s/it]
 25%|██▍       | 467/1875 [1:12:40<3:35:33,  9.19s/it]
 25%|██▍       | 468/1875 [1:12:49<3:32:04,  9.04s/it]
 25%|██▌       | 469/1875 [1:12:59<3:38:36,  9.33s/it]
 25%|██▌       | 470/1875 [1:13:10<3:55:17, 10.05s/it]Error in loading 183680 of [gpt4v-dataset/images/gpt_v4244.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v4244.jpg'], retrying...

 25%|██▌       | 471/1875 [1:13:20<3:51:21,  9.89s/it]
 25%|██▌       | 472/1875 [1:13:29<3:48:59,  9.79s/it]
 25%|██▌       | 473/1875 [1:13:38<3:42:18,  9.51s/it]
 25%|██▌       | 474/1875 [1:13:47<3:39:36,  9.41s/it]
 25%|██▌       | 475/1875 [1:13:56<3:36:11,  9.27s/it]
 25%|██▌       | 476/1875 [1:14:05<3:32:31,  9.11s/it]
 25%|██▌       | 477/1875 [1:14:14<3:29:57,  9.01s/it]
 25%|██▌       | 478/1875 [1:14:23<3:27:38,  8.92s/it]
 26%|██▌       | 479/1875 [1:14:32<3:27:30,  8.92s/it]
 26%|██▌       | 480/1875 [1:14:40<3:27:11,  8.91s/it]
 26%|██▌       | 481/1875 [1:14:49<3:26:52,  8.90s/it]
 26%|██▌       | 482/1875 [1:14:59<3:29:52,  9.04s/it]
 26%|██▌       | 483/1875 [1:15:07<3:27:32,  8.95s/it]
 26%|██▌       | 484/1875 [1:15:16<3:26:33,  8.91s/it]
 26%|██▌       | 485/1875 [1:15:26<3:29:40,  9.05s/it]
 26%|██▌       | 486/1875 [1:15:35<3:31:26,  9.13s/it]
 26%|██▌       | 487/1875 [1:15:44<3:31:33,  9.15s/it]
 26%|██▌       | 488/1875 [1:15:53<3:30:58,  9.13s/it]
 26%|██▌       | 489/1875 [1:16:02<3:31:23,  9.15s/it]
 26%|██▌       | 490/1875 [1:16:11<3:30:09,  9.10s/it]
 26%|██▌       | 491/1875 [1:16:20<3:29:05,  9.06s/it]
 26%|██▌       | 492/1875 [1:16:29<3:28:37,  9.05s/it]
 26%|██▋       | 493/1875 [1:16:39<3:30:20,  9.13s/it]
 26%|██▋       | 494/1875 [1:16:48<3:30:04,  9.13s/it]
 26%|██▋       | 495/1875 [1:16:57<3:30:17,  9.14s/it]
 26%|██▋       | 496/1875 [1:17:06<3:28:05,  9.05s/it]
 27%|██▋       | 497/1875 [1:17:15<3:27:28,  9.03s/it]
 27%|██▋       | 498/1875 [1:17:24<3:26:42,  9.01s/it]
 27%|██▋       | 499/1875 [1:17:33<3:27:41,  9.06s/it]
 27%|██▋       | 500/1875 [1:17:42<3:27:22,  9.05s/it]
                                                      
{'loss': 1.3404, 'grad_norm': 3.017906704315344, 'learning_rate': 1.721018258557333e-05, 'epoch': 0.27}

 27%|██▋       | 500/1875 [1:17:42<3:27:22,  9.05s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 27%|██▋       | 501/1875 [1:18:16<6:22:09, 16.69s/it]
 27%|██▋       | 502/1875 [1:18:25<5:26:24, 14.26s/it]
 27%|██▋       | 503/1875 [1:18:34<4:48:23, 12.61s/it]
 27%|██▋       | 504/1875 [1:18:42<4:20:52, 11.42s/it]
 27%|██▋       | 505/1875 [1:18:51<4:02:53, 10.64s/it]
 27%|██▋       | 506/1875 [1:19:01<3:53:08, 10.22s/it]
 27%|██▋       | 507/1875 [1:19:18<4:44:37, 12.48s/it]
 27%|██▋       | 508/1875 [1:19:27<4:20:05, 11.42s/it]
 27%|██▋       | 509/1875 [1:19:36<4:01:39, 10.61s/it]
 27%|██▋       | 510/1875 [1:19:45<3:49:18, 10.08s/it]
 27%|██▋       | 511/1875 [1:19:54<3:40:54,  9.72s/it]
 27%|██▋       | 512/1875 [1:20:03<3:35:10,  9.47s/it]
 27%|██▋       | 513/1875 [1:20:11<3:31:05,  9.30s/it]
 27%|██▋       | 514/1875 [1:20:20<3:27:32,  9.15s/it]
 27%|██▋       | 515/1875 [1:20:29<3:25:17,  9.06s/it]
 28%|██▊       | 516/1875 [1:20:38<3:24:43,  9.04s/it]
 28%|██▊       | 517/1875 [1:20:47<3:21:45,  8.91s/it]
 28%|██▊       | 518/1875 [1:20:56<3:21:48,  8.92s/it]
 28%|██▊       | 519/1875 [1:21:05<3:23:30,  9.01s/it]Error in loading 55291 of [gpt4v-dataset/images/gpt_v11097.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v11097.jpg'], retrying...

 28%|██▊       | 520/1875 [1:21:14<3:23:58,  9.03s/it]
 28%|██▊       | 521/1875 [1:21:23<3:22:09,  8.96s/it]
 28%|██▊       | 522/1875 [1:21:32<3:23:07,  9.01s/it]
 28%|██▊       | 523/1875 [1:21:40<3:20:00,  8.88s/it]
 28%|██▊       | 524/1875 [1:21:49<3:20:43,  8.91s/it]
 28%|██▊       | 525/1875 [1:21:59<3:21:55,  8.97s/it]
 28%|██▊       | 526/1875 [1:22:08<3:22:57,  9.03s/it]Error in loading 1303 of [gpt4v-dataset/images/gpt_v9089.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v9089.jpg'], retrying...

 28%|██▊       | 527/1875 [1:22:20<3:46:54, 10.10s/it]
 28%|██▊       | 528/1875 [1:22:40<4:48:33, 12.85s/it]
 28%|██▊       | 529/1875 [1:22:48<4:20:06, 11.59s/it]
 28%|██▊       | 530/1875 [1:22:57<4:03:36, 10.87s/it]
 28%|██▊       | 531/1875 [1:23:06<3:50:01, 10.27s/it]
 28%|██▊       | 532/1875 [1:23:15<3:40:04,  9.83s/it]
 28%|██▊       | 533/1875 [1:23:24<3:35:01,  9.61s/it]
 28%|██▊       | 534/1875 [1:23:33<3:30:53,  9.44s/it]
 29%|██▊       | 535/1875 [1:23:42<3:28:24,  9.33s/it]
 29%|██▊       | 536/1875 [1:23:52<3:29:21,  9.38s/it]
 29%|██▊       | 537/1875 [1:24:01<3:25:43,  9.23s/it]
 29%|██▊       | 538/1875 [1:24:10<3:24:41,  9.19s/it]
 29%|██▊       | 539/1875 [1:24:19<3:22:21,  9.09s/it]
 29%|██▉       | 540/1875 [1:24:28<3:22:54,  9.12s/it]
 29%|██▉       | 541/1875 [1:24:37<3:21:55,  9.08s/it]
 29%|██▉       | 542/1875 [1:24:46<3:19:30,  8.98s/it]
 29%|██▉       | 543/1875 [1:24:55<3:19:12,  8.97s/it]
 29%|██▉       | 544/1875 [1:25:04<3:19:25,  8.99s/it]
 29%|██▉       | 545/1875 [1:25:13<3:19:43,  9.01s/it]
 29%|██▉       | 546/1875 [1:25:21<3:18:45,  8.97s/it]
 29%|██▉       | 547/1875 [1:25:30<3:18:21,  8.96s/it]
 29%|██▉       | 548/1875 [1:25:39<3:16:17,  8.87s/it]
 29%|██▉       | 549/1875 [1:25:49<3:21:45,  9.13s/it]
 29%|██▉       | 550/1875 [1:25:59<3:29:29,  9.49s/it]
                                                      
{'loss': 1.3534, 'grad_norm': 2.7678496323338173, 'learning_rate': 1.6585334207993475e-05, 'epoch': 0.29}

 29%|██▉       | 550/1875 [1:25:59<3:29:29,  9.49s/it]
 29%|██▉       | 551/1875 [1:26:08<3:27:58,  9.42s/it]
 29%|██▉       | 552/1875 [1:26:17<3:24:20,  9.27s/it]
 29%|██▉       | 553/1875 [1:26:26<3:21:12,  9.13s/it]
 30%|██▉       | 554/1875 [1:26:35<3:18:59,  9.04s/it]
 30%|██▉       | 555/1875 [1:26:45<3:27:13,  9.42s/it]
 30%|██▉       | 556/1875 [1:26:55<3:27:43,  9.45s/it]
 30%|██▉       | 557/1875 [1:27:04<3:25:44,  9.37s/it]
 30%|██▉       | 558/1875 [1:27:13<3:22:19,  9.22s/it]
 30%|██▉       | 559/1875 [1:27:22<3:23:37,  9.28s/it]
 30%|██▉       | 560/1875 [1:27:31<3:22:01,  9.22s/it]
 30%|██▉       | 561/1875 [1:27:40<3:19:55,  9.13s/it]
 30%|██▉       | 562/1875 [1:27:49<3:19:35,  9.12s/it]
 30%|███       | 563/1875 [1:27:58<3:17:23,  9.03s/it]
 30%|███       | 564/1875 [1:28:07<3:17:04,  9.02s/it]
 30%|███       | 565/1875 [1:28:16<3:15:56,  8.97s/it]
 30%|███       | 566/1875 [1:28:25<3:14:27,  8.91s/it]
 30%|███       | 567/1875 [1:28:34<3:13:58,  8.90s/it]
 30%|███       | 568/1875 [1:28:43<3:16:14,  9.01s/it]
 30%|███       | 569/1875 [1:28:52<3:15:09,  8.97s/it]
 30%|███       | 570/1875 [1:29:01<3:15:27,  8.99s/it]
 30%|███       | 571/1875 [1:29:10<3:14:54,  8.97s/it]
 31%|███       | 572/1875 [1:29:19<3:19:12,  9.17s/it]Error in loading 81124 of [gpt4v-dataset/images/gpt_v4829.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v4829.jpg'], retrying...

 31%|███       | 573/1875 [1:29:29<3:19:31,  9.20s/it]
 31%|███       | 574/1875 [1:29:38<3:18:08,  9.14s/it]
 31%|███       | 575/1875 [1:29:47<3:18:07,  9.14s/it]
 31%|███       | 576/1875 [1:29:56<3:17:20,  9.11s/it]
 31%|███       | 577/1875 [1:30:05<3:18:20,  9.17s/it]
 31%|███       | 578/1875 [1:30:14<3:18:15,  9.17s/it]
 31%|███       | 579/1875 [1:30:24<3:19:24,  9.23s/it]
 31%|███       | 580/1875 [1:30:34<3:23:03,  9.41s/it]
 31%|███       | 581/1875 [1:30:42<3:19:36,  9.26s/it]
 31%|███       | 582/1875 [1:30:52<3:19:07,  9.24s/it]
 31%|███       | 583/1875 [1:31:00<3:16:15,  9.11s/it]
 31%|███       | 584/1875 [1:31:09<3:15:20,  9.08s/it]
 31%|███       | 585/1875 [1:31:18<3:14:32,  9.05s/it]
 31%|███▏      | 586/1875 [1:31:27<3:13:33,  9.01s/it]
 31%|███▏      | 587/1875 [1:31:36<3:12:21,  8.96s/it]
 31%|███▏      | 588/1875 [1:31:45<3:11:15,  8.92s/it]
 31%|███▏      | 589/1875 [1:31:54<3:10:45,  8.90s/it]
 31%|███▏      | 590/1875 [1:32:03<3:12:02,  8.97s/it]
 32%|███▏      | 591/1875 [1:32:12<3:13:49,  9.06s/it]
 32%|███▏      | 592/1875 [1:32:21<3:12:20,  9.00s/it]
 32%|███▏      | 593/1875 [1:32:30<3:10:42,  8.93s/it]
 32%|███▏      | 594/1875 [1:32:39<3:10:23,  8.92s/it]
 32%|███▏      | 595/1875 [1:32:48<3:09:34,  8.89s/it]
 32%|███▏      | 596/1875 [1:32:57<3:09:52,  8.91s/it]
 32%|███▏      | 597/1875 [1:33:05<3:09:39,  8.90s/it]
 32%|███▏      | 598/1875 [1:33:14<3:09:39,  8.91s/it]Error in loading 228946 of [gpt4v-dataset/images/gpt_v11202.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v11202.jpg'], retrying...

 32%|███▏      | 599/1875 [1:33:23<3:10:09,  8.94s/it]
 32%|███▏      | 600/1875 [1:33:32<3:10:49,  8.98s/it]
                                                      
{'loss': 1.3295, 'grad_norm': 3.0760575295192396, 'learning_rate': 1.5911354376198468e-05, 'epoch': 0.32}

 32%|███▏      | 600/1875 [1:33:32<3:10:49,  8.98s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 32%|███▏      | 601/1875 [1:34:06<5:49:55, 16.48s/it]
 32%|███▏      | 602/1875 [1:34:15<5:01:46, 14.22s/it]
 32%|███▏      | 603/1875 [1:34:24<4:28:38, 12.67s/it]Error in loading 70307 of [gpt4v-dataset/images/gpt_v5895.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v5895.jpg'], retrying...

 32%|███▏      | 604/1875 [1:34:34<4:06:22, 11.63s/it]
 32%|███▏      | 605/1875 [1:34:42<3:48:23, 10.79s/it]
 32%|███▏      | 606/1875 [1:34:51<3:34:52, 10.16s/it]
 32%|███▏      | 607/1875 [1:35:00<3:26:18,  9.76s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (4359 > 2048). Running this sequence through the model will result in indexing errors

 32%|███▏      | 608/1875 [1:35:09<3:21:00,  9.52s/it]
 32%|███▏      | 609/1875 [1:35:19<3:23:13,  9.63s/it]
 33%|███▎      | 610/1875 [1:35:28<3:18:57,  9.44s/it]
 33%|███▎      | 611/1875 [1:35:37<3:16:11,  9.31s/it]
 33%|███▎      | 612/1875 [1:35:46<3:14:02,  9.22s/it]
 33%|███▎      | 613/1875 [1:35:55<3:13:25,  9.20s/it]
 33%|███▎      | 614/1875 [1:36:04<3:13:09,  9.19s/it]
 33%|███▎      | 615/1875 [1:36:14<3:14:36,  9.27s/it]
 33%|███▎      | 616/1875 [1:36:23<3:13:43,  9.23s/it]
 33%|███▎      | 617/1875 [1:36:32<3:12:24,  9.18s/it]
 33%|███▎      | 618/1875 [1:36:41<3:11:11,  9.13s/it]
 33%|███▎      | 619/1875 [1:36:50<3:09:19,  9.04s/it]
 33%|███▎      | 620/1875 [1:36:59<3:09:10,  9.04s/it]
 33%|███▎      | 621/1875 [1:37:08<3:09:26,  9.06s/it]
 33%|███▎      | 622/1875 [1:37:17<3:09:49,  9.09s/it]
 33%|███▎      | 623/1875 [1:37:26<3:08:26,  9.03s/it]
 33%|███▎      | 624/1875 [1:37:35<3:07:20,  8.99s/it]
 33%|███▎      | 625/1875 [1:37:44<3:07:04,  8.98s/it]
 33%|███▎      | 626/1875 [1:37:53<3:08:56,  9.08s/it]
 33%|███▎      | 627/1875 [1:38:02<3:07:45,  9.03s/it]
 33%|███▎      | 628/1875 [1:38:11<3:05:47,  8.94s/it]
 34%|███▎      | 629/1875 [1:38:19<3:04:46,  8.90s/it]
 34%|███▎      | 630/1875 [1:38:28<3:05:14,  8.93s/it]
 34%|███▎      | 631/1875 [1:38:38<3:05:51,  8.96s/it]
 34%|███▎      | 632/1875 [1:38:47<3:08:20,  9.09s/it]
 34%|███▍      | 633/1875 [1:38:56<3:06:14,  9.00s/it]
 34%|███▍      | 634/1875 [1:39:05<3:05:59,  8.99s/it]
 34%|███▍      | 635/1875 [1:39:14<3:06:03,  9.00s/it]
 34%|███▍      | 636/1875 [1:39:22<3:04:00,  8.91s/it]
 34%|███▍      | 637/1875 [1:39:31<3:04:22,  8.94s/it]
 34%|███▍      | 638/1875 [1:39:40<3:05:09,  8.98s/it]
 34%|███▍      | 639/1875 [1:39:49<3:05:15,  8.99s/it]
 34%|███▍      | 640/1875 [1:39:58<3:03:47,  8.93s/it]
 34%|███▍      | 641/1875 [1:40:07<3:02:44,  8.89s/it]
 34%|███▍      | 642/1875 [1:40:16<3:03:39,  8.94s/it]
 34%|███▍      | 643/1875 [1:40:25<3:03:21,  8.93s/it]
 34%|███▍      | 644/1875 [1:40:34<3:03:30,  8.94s/it]
 34%|███▍      | 645/1875 [1:40:43<3:03:31,  8.95s/it]
 34%|███▍      | 646/1875 [1:40:52<3:02:49,  8.93s/it]
 35%|███▍      | 647/1875 [1:41:01<3:02:53,  8.94s/it]
 35%|███▍      | 648/1875 [1:41:10<3:04:52,  9.04s/it]
 35%|███▍      | 649/1875 [1:41:19<3:05:20,  9.07s/it]
 35%|███▍      | 650/1875 [1:41:28<3:04:14,  9.02s/it]
                                                      
{'loss': 1.3333, 'grad_norm': 3.073298230848129, 'learning_rate': 1.5193271477237761e-05, 'epoch': 0.35}

 35%|███▍      | 650/1875 [1:41:28<3:04:14,  9.02s/it]
 35%|███▍      | 651/1875 [1:41:37<3:03:12,  8.98s/it]
 35%|███▍      | 652/1875 [1:41:46<3:03:03,  8.98s/it]
 35%|███▍      | 653/1875 [1:41:55<3:02:18,  8.95s/it]
 35%|███▍      | 654/1875 [1:42:04<3:01:35,  8.92s/it]
 35%|███▍      | 655/1875 [1:42:12<2:59:56,  8.85s/it]
 35%|███▍      | 656/1875 [1:42:21<3:01:01,  8.91s/it]
 35%|███▌      | 657/1875 [1:42:30<3:01:14,  8.93s/it]
 35%|███▌      | 658/1875 [1:42:40<3:02:37,  9.00s/it]
 35%|███▌      | 659/1875 [1:42:49<3:02:49,  9.02s/it]
 35%|███▌      | 660/1875 [1:42:57<3:00:34,  8.92s/it]
 35%|███▌      | 661/1875 [1:43:07<3:02:40,  9.03s/it]
 35%|███▌      | 662/1875 [1:43:16<3:02:16,  9.02s/it]
 35%|███▌      | 663/1875 [1:43:24<3:00:59,  8.96s/it]
 35%|███▌      | 664/1875 [1:43:33<3:00:58,  8.97s/it]
 35%|███▌      | 665/1875 [1:43:43<3:02:00,  9.03s/it]
 36%|███▌      | 666/1875 [1:43:52<3:01:19,  9.00s/it]
 36%|███▌      | 667/1875 [1:44:00<3:00:52,  8.98s/it]
 36%|███▌      | 668/1875 [1:44:10<3:01:18,  9.01s/it]
 36%|███▌      | 669/1875 [1:44:18<3:00:32,  8.98s/it]
 36%|███▌      | 670/1875 [1:44:27<2:59:29,  8.94s/it]
 36%|███▌      | 671/1875 [1:44:36<2:59:31,  8.95s/it]
 36%|███▌      | 672/1875 [1:44:45<3:00:04,  8.98s/it]
 36%|███▌      | 673/1875 [1:44:54<2:58:53,  8.93s/it]
 36%|███▌      | 674/1875 [1:45:03<2:58:18,  8.91s/it]
 36%|███▌      | 675/1875 [1:45:12<2:57:44,  8.89s/it]
 36%|███▌      | 676/1875 [1:45:21<2:58:46,  8.95s/it]
 36%|███▌      | 677/1875 [1:45:30<3:00:03,  9.02s/it]
 36%|███▌      | 678/1875 [1:45:39<3:02:00,  9.12s/it]
 36%|███▌      | 679/1875 [1:45:48<3:00:19,  9.05s/it]
 36%|███▋      | 680/1875 [1:45:57<3:00:40,  9.07s/it]
 36%|███▋      | 681/1875 [1:46:06<2:59:09,  9.00s/it]
 36%|███▋      | 682/1875 [1:46:15<2:58:07,  8.96s/it]
 36%|███▋      | 683/1875 [1:46:24<2:56:03,  8.86s/it]
 36%|███▋      | 684/1875 [1:46:33<2:55:18,  8.83s/it]
 37%|███▋      | 685/1875 [1:46:41<2:55:22,  8.84s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/PIL/TiffImagePlugin.py:900: UserWarning: Truncated File Read
  warnings.warn(str(msg))

 37%|███▋      | 686/1875 [1:46:50<2:55:31,  8.86s/it]
 37%|███▋      | 687/1875 [1:46:59<2:56:20,  8.91s/it]
 37%|███▋      | 688/1875 [1:47:08<2:54:56,  8.84s/it]
 37%|███▋      | 689/1875 [1:47:17<2:55:01,  8.85s/it]
 37%|███▋      | 690/1875 [1:47:26<2:55:51,  8.90s/it]
 37%|███▋      | 691/1875 [1:47:35<2:56:27,  8.94s/it]
 37%|███▋      | 692/1875 [1:47:44<2:55:37,  8.91s/it]
 37%|███▋      | 693/1875 [1:47:53<2:55:39,  8.92s/it]
 37%|███▋      | 694/1875 [1:48:02<2:57:13,  9.00s/it]
 37%|███▋      | 695/1875 [1:48:25<4:18:02, 13.12s/it]
 37%|███▋      | 696/1875 [1:48:34<3:53:54, 11.90s/it]Error in loading 52629 of [gpt4v-dataset/images/gpt_v2246.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v2246.jpg'], retrying...

 37%|███▋      | 697/1875 [1:48:43<3:36:28, 11.03s/it]
 37%|███▋      | 698/1875 [1:48:51<3:22:22, 10.32s/it]
 37%|███▋      | 699/1875 [1:49:00<3:13:06,  9.85s/it]
 37%|███▋      | 700/1875 [1:49:09<3:08:13,  9.61s/it]
                                                      
{'loss': 1.3214, 'grad_norm': 2.9745979527634865, 'learning_rate': 1.443644293959693e-05, 'epoch': 0.37}

 37%|███▋      | 700/1875 [1:49:09<3:08:13,  9.61s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 37%|███▋      | 701/1875 [1:49:42<5:26:04, 16.66s/it]
 37%|███▋      | 702/1875 [1:49:51<4:40:47, 14.36s/it]
 37%|███▋      | 703/1875 [1:50:00<4:08:45, 12.74s/it]
 38%|███▊      | 704/1875 [1:50:09<3:46:08, 11.59s/it]
 38%|███▊      | 705/1875 [1:50:18<3:28:53, 10.71s/it]
 38%|███▊      | 706/1875 [1:50:27<3:17:17, 10.13s/it]
 38%|███▊      | 707/1875 [1:50:36<3:10:00,  9.76s/it]
 38%|███▊      | 708/1875 [1:50:44<3:04:26,  9.48s/it]
 38%|███▊      | 709/1875 [1:50:53<3:00:49,  9.30s/it]
 38%|███▊      | 710/1875 [1:51:02<2:57:44,  9.15s/it]
 38%|███▊      | 711/1875 [1:51:11<2:54:55,  9.02s/it]
 38%|███▊      | 712/1875 [1:51:20<2:53:31,  8.95s/it]
 38%|███▊      | 713/1875 [1:51:28<2:52:15,  8.89s/it]
 38%|███▊      | 714/1875 [1:51:37<2:50:49,  8.83s/it]
 38%|███▊      | 715/1875 [1:51:46<2:50:04,  8.80s/it]
 38%|███▊      | 716/1875 [1:51:54<2:49:05,  8.75s/it]
 38%|███▊      | 717/1875 [1:52:03<2:49:17,  8.77s/it]
 38%|███▊      | 718/1875 [1:52:12<2:50:41,  8.85s/it]
 38%|███▊      | 719/1875 [1:52:21<2:49:34,  8.80s/it]
 38%|███▊      | 720/1875 [1:52:30<2:51:09,  8.89s/it]Error in loading 167708 of [gpt4v-dataset/images/gpt_v10115.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v10115.jpg'], retrying...

 38%|███▊      | 721/1875 [1:52:39<2:51:51,  8.94s/it]
 39%|███▊      | 722/1875 [1:52:48<2:50:42,  8.88s/it]
 39%|███▊      | 723/1875 [1:52:57<2:51:24,  8.93s/it]
 39%|███▊      | 724/1875 [1:53:06<2:51:27,  8.94s/it]
 39%|███▊      | 725/1875 [1:53:15<2:51:50,  8.97s/it]
 39%|███▊      | 726/1875 [1:53:24<2:50:29,  8.90s/it]
 39%|███▉      | 727/1875 [1:53:32<2:50:06,  8.89s/it]
 39%|███▉      | 728/1875 [1:53:41<2:50:16,  8.91s/it]
 39%|███▉      | 729/1875 [1:53:50<2:50:24,  8.92s/it]
 39%|███▉      | 730/1875 [1:53:59<2:51:12,  8.97s/it]
 39%|███▉      | 731/1875 [1:54:08<2:49:09,  8.87s/it]
 39%|███▉      | 732/1875 [1:54:17<2:48:53,  8.87s/it]
 39%|███▉      | 733/1875 [1:54:26<2:48:15,  8.84s/it]
 39%|███▉      | 734/1875 [1:54:34<2:46:40,  8.76s/it]
 39%|███▉      | 735/1875 [1:54:43<2:46:37,  8.77s/it]
 39%|███▉      | 736/1875 [1:54:52<2:49:19,  8.92s/it]
 39%|███▉      | 737/1875 [1:55:01<2:49:01,  8.91s/it]
 39%|███▉      | 738/1875 [1:55:10<2:48:35,  8.90s/it]
 39%|███▉      | 739/1875 [1:55:19<2:48:20,  8.89s/it]
 39%|███▉      | 740/1875 [1:55:28<2:46:57,  8.83s/it]
 40%|███▉      | 741/1875 [1:55:37<2:48:51,  8.93s/it]
 40%|███▉      | 742/1875 [1:55:45<2:47:17,  8.86s/it]
 40%|███▉      | 743/1875 [1:55:54<2:46:16,  8.81s/it]
 40%|███▉      | 744/1875 [1:56:03<2:46:24,  8.83s/it]
 40%|███▉      | 745/1875 [1:56:12<2:47:58,  8.92s/it]
 40%|███▉      | 746/1875 [1:56:21<2:46:19,  8.84s/it]
 40%|███▉      | 747/1875 [1:56:31<2:56:13,  9.37s/it]
 40%|███▉      | 748/1875 [1:56:40<2:53:07,  9.22s/it]
 40%|███▉      | 749/1875 [1:56:49<2:51:40,  9.15s/it]
 40%|████      | 750/1875 [1:56:58<2:50:42,  9.10s/it]
                                                      
{'loss': 1.3159, 'grad_norm': 2.9775318463608076, 'learning_rate': 1.3646515262826551e-05, 'epoch': 0.4}

 40%|████      | 750/1875 [1:56:58<2:50:42,  9.10s/it]
 40%|████      | 751/1875 [1:57:07<2:49:52,  9.07s/it]
 40%|████      | 752/1875 [1:57:16<2:49:06,  9.04s/it]
 40%|████      | 753/1875 [1:57:25<2:47:13,  8.94s/it]
 40%|████      | 754/1875 [1:57:34<2:47:12,  8.95s/it]
 40%|████      | 755/1875 [1:57:43<2:46:45,  8.93s/it]
 40%|████      | 756/1875 [1:57:52<2:46:13,  8.91s/it]
 40%|████      | 757/1875 [1:58:01<2:47:33,  8.99s/it]
 40%|████      | 758/1875 [1:58:10<2:47:07,  8.98s/it]
 40%|████      | 759/1875 [1:58:19<2:46:09,  8.93s/it]
 41%|████      | 760/1875 [1:58:27<2:45:14,  8.89s/it]
 41%|████      | 761/1875 [1:58:36<2:45:12,  8.90s/it]
 41%|████      | 762/1875 [1:58:46<2:48:46,  9.10s/it]
 41%|████      | 763/1875 [1:58:55<2:47:29,  9.04s/it]
 41%|████      | 764/1875 [1:59:04<2:47:57,  9.07s/it]
 41%|████      | 765/1875 [1:59:13<2:47:02,  9.03s/it]
 41%|████      | 766/1875 [1:59:22<2:49:29,  9.17s/it]
 41%|████      | 767/1875 [1:59:31<2:47:15,  9.06s/it]
 41%|████      | 768/1875 [1:59:41<2:49:07,  9.17s/it]
 41%|████      | 769/1875 [1:59:49<2:46:39,  9.04s/it]
 41%|████      | 770/1875 [1:59:58<2:45:34,  8.99s/it]
 41%|████      | 771/1875 [2:00:07<2:44:34,  8.94s/it]
 41%|████      | 772/1875 [2:00:16<2:43:17,  8.88s/it]
 41%|████      | 773/1875 [2:00:25<2:42:30,  8.85s/it]
 41%|████▏     | 774/1875 [2:00:34<2:43:31,  8.91s/it]
 41%|████▏     | 775/1875 [2:00:43<2:43:36,  8.92s/it]
 41%|████▏     | 776/1875 [2:00:51<2:42:58,  8.90s/it]
 41%|████▏     | 777/1875 [2:01:00<2:43:05,  8.91s/it]
 41%|████▏     | 778/1875 [2:01:09<2:42:51,  8.91s/it]
 42%|████▏     | 779/1875 [2:01:18<2:42:24,  8.89s/it]
 42%|████▏     | 780/1875 [2:01:27<2:42:04,  8.88s/it]
 42%|████▏     | 781/1875 [2:01:36<2:41:15,  8.84s/it]
 42%|████▏     | 782/1875 [2:01:45<2:44:26,  9.03s/it]
 42%|████▏     | 783/1875 [2:01:55<2:45:59,  9.12s/it]
 42%|████▏     | 784/1875 [2:02:03<2:43:39,  9.00s/it]
 42%|████▏     | 785/1875 [2:02:12<2:41:55,  8.91s/it]
 42%|████▏     | 786/1875 [2:02:21<2:40:50,  8.86s/it]
 42%|████▏     | 787/1875 [2:02:30<2:40:55,  8.87s/it]
 42%|████▏     | 788/1875 [2:02:38<2:39:55,  8.83s/it]
 42%|████▏     | 789/1875 [2:02:47<2:41:13,  8.91s/it]
 42%|████▏     | 790/1875 [2:02:56<2:41:39,  8.94s/it]
 42%|████▏     | 791/1875 [2:03:05<2:40:06,  8.86s/it]
 42%|████▏     | 792/1875 [2:03:14<2:41:13,  8.93s/it]
 42%|████▏     | 793/1875 [2:03:23<2:41:38,  8.96s/it]
 42%|████▏     | 794/1875 [2:03:32<2:40:21,  8.90s/it]
 42%|████▏     | 795/1875 [2:03:41<2:40:07,  8.90s/it]
 42%|████▏     | 796/1875 [2:03:50<2:38:41,  8.82s/it]
 43%|████▎     | 797/1875 [2:03:59<2:40:05,  8.91s/it]
 43%|████▎     | 798/1875 [2:04:07<2:38:49,  8.85s/it]
 43%|████▎     | 799/1875 [2:04:16<2:38:09,  8.82s/it]
 43%|████▎     | 800/1875 [2:04:25<2:37:12,  8.77s/it]
                                                      
{'loss': 1.2925, 'grad_norm': 3.256228718706964, 'learning_rate': 1.2829381890487536e-05, 'epoch': 0.43}

 43%|████▎     | 800/1875 [2:04:25<2:37:12,  8.77s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 43%|████▎     | 801/1875 [2:04:56<4:37:19, 15.49s/it]
 43%|████▎     | 802/1875 [2:05:05<4:01:40, 13.51s/it]
 43%|████▎     | 803/1875 [2:05:14<3:36:13, 12.10s/it]
 43%|████▎     | 804/1875 [2:05:23<3:18:59, 11.15s/it]
 43%|████▎     | 805/1875 [2:05:31<3:06:05, 10.43s/it]
 43%|████▎     | 806/1875 [2:05:40<2:56:36,  9.91s/it]
 43%|████▎     | 807/1875 [2:05:49<2:50:47,  9.59s/it]
 43%|████▎     | 808/1875 [2:05:58<2:46:45,  9.38s/it]
 43%|████▎     | 809/1875 [2:06:06<2:42:38,  9.15s/it]
 43%|████▎     | 810/1875 [2:06:15<2:40:06,  9.02s/it]
 43%|████▎     | 811/1875 [2:06:24<2:39:01,  8.97s/it]
 43%|████▎     | 812/1875 [2:06:33<2:38:13,  8.93s/it]
 43%|████▎     | 813/1875 [2:06:42<2:38:43,  8.97s/it]
 43%|████▎     | 814/1875 [2:06:51<2:37:46,  8.92s/it]
 43%|████▎     | 815/1875 [2:06:59<2:36:01,  8.83s/it]
 44%|████▎     | 816/1875 [2:07:08<2:37:18,  8.91s/it]
 44%|████▎     | 817/1875 [2:07:17<2:36:03,  8.85s/it]
 44%|████▎     | 818/1875 [2:07:26<2:34:51,  8.79s/it]
 44%|████▎     | 819/1875 [2:07:34<2:34:14,  8.76s/it]
 44%|████▎     | 820/1875 [2:07:43<2:34:11,  8.77s/it]
 44%|████▍     | 821/1875 [2:07:52<2:34:53,  8.82s/it]
 44%|████▍     | 822/1875 [2:08:01<2:35:19,  8.85s/it]
 44%|████▍     | 823/1875 [2:08:10<2:35:31,  8.87s/it]
 44%|████▍     | 824/1875 [2:08:19<2:35:18,  8.87s/it]
 44%|████▍     | 825/1875 [2:08:28<2:36:49,  8.96s/it]
 44%|████▍     | 826/1875 [2:08:37<2:35:39,  8.90s/it]
 44%|████▍     | 827/1875 [2:08:46<2:34:59,  8.87s/it]
 44%|████▍     | 828/1875 [2:08:54<2:34:25,  8.85s/it]
 44%|████▍     | 829/1875 [2:09:04<2:35:33,  8.92s/it]
 44%|████▍     | 830/1875 [2:09:13<2:39:51,  9.18s/it]
 44%|████▍     | 831/1875 [2:09:22<2:38:38,  9.12s/it]Error in loading 40353 of [gpt4v-dataset/images/gpt_v166.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v166.jpg'], retrying...

 44%|████▍     | 832/1875 [2:09:31<2:35:32,  8.95s/it]
 44%|████▍     | 833/1875 [2:09:40<2:34:32,  8.90s/it]
 44%|████▍     | 834/1875 [2:09:48<2:33:57,  8.87s/it]
 45%|████▍     | 835/1875 [2:09:57<2:33:53,  8.88s/it]
 45%|████▍     | 836/1875 [2:10:06<2:33:31,  8.87s/it]
 45%|████▍     | 837/1875 [2:10:15<2:32:08,  8.79s/it]
 45%|████▍     | 838/1875 [2:10:24<2:32:38,  8.83s/it]
 45%|████▍     | 839/1875 [2:10:33<2:32:31,  8.83s/it]
 45%|████▍     | 840/1875 [2:10:42<2:33:25,  8.89s/it]
 45%|████▍     | 841/1875 [2:10:51<2:33:44,  8.92s/it]
 45%|████▍     | 842/1875 [2:11:00<2:34:42,  8.99s/it]
 45%|████▍     | 843/1875 [2:11:09<2:35:47,  9.06s/it]
 45%|████▌     | 844/1875 [2:11:18<2:35:09,  9.03s/it]
 45%|████▌     | 845/1875 [2:11:27<2:33:33,  8.94s/it]
 45%|████▌     | 846/1875 [2:11:36<2:34:23,  9.00s/it]
 45%|████▌     | 847/1875 [2:11:45<2:34:03,  8.99s/it]
 45%|████▌     | 848/1875 [2:11:54<2:33:10,  8.95s/it]
 45%|████▌     | 849/1875 [2:12:03<2:33:48,  8.99s/it]
 45%|████▌     | 850/1875 [2:12:12<2:33:09,  8.97s/it]
                                                      
{'loss': 1.3084, 'grad_norm': 2.7887490599613898, 'learning_rate': 1.1991139240711857e-05, 'epoch': 0.45}

 45%|████▌     | 850/1875 [2:12:12<2:33:09,  8.97s/it]
 45%|████▌     | 851/1875 [2:12:20<2:32:51,  8.96s/it]
 45%|████▌     | 852/1875 [2:12:29<2:32:47,  8.96s/it]Error in loading 56105 of [gpt4v-dataset/images/gpt_v9572.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v9572.jpg'], retrying...

 45%|████▌     | 853/1875 [2:12:38<2:31:56,  8.92s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/PIL/Image.py:1056: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  warnings.warn(

 46%|████▌     | 854/1875 [2:12:47<2:31:48,  8.92s/it]
 46%|████▌     | 855/1875 [2:12:56<2:31:49,  8.93s/it]
 46%|████▌     | 856/1875 [2:13:05<2:31:48,  8.94s/it]
 46%|████▌     | 857/1875 [2:13:14<2:30:30,  8.87s/it]
 46%|████▌     | 858/1875 [2:13:23<2:30:11,  8.86s/it]
 46%|████▌     | 859/1875 [2:13:32<2:31:38,  8.96s/it]
 46%|████▌     | 860/1875 [2:13:41<2:30:13,  8.88s/it]
 46%|████▌     | 861/1875 [2:13:49<2:29:25,  8.84s/it]
 46%|████▌     | 862/1875 [2:13:58<2:29:42,  8.87s/it]
 46%|████▌     | 863/1875 [2:14:07<2:28:31,  8.81s/it]
 46%|████▌     | 864/1875 [2:14:16<2:29:18,  8.86s/it]
 46%|████▌     | 865/1875 [2:14:25<2:30:19,  8.93s/it]
 46%|████▌     | 866/1875 [2:14:34<2:29:27,  8.89s/it]
 46%|████▌     | 867/1875 [2:14:43<2:28:50,  8.86s/it]
 46%|████▋     | 868/1875 [2:14:51<2:28:41,  8.86s/it]
 46%|████▋     | 869/1875 [2:15:00<2:28:23,  8.85s/it]
 46%|████▋     | 870/1875 [2:15:09<2:27:20,  8.80s/it]
 46%|████▋     | 871/1875 [2:15:18<2:26:51,  8.78s/it]
 47%|████▋     | 872/1875 [2:15:26<2:26:27,  8.76s/it]
 47%|████▋     | 873/1875 [2:15:35<2:28:05,  8.87s/it]
 47%|████▋     | 874/1875 [2:15:45<2:28:48,  8.92s/it]
 47%|████▋     | 875/1875 [2:15:54<2:29:07,  8.95s/it]
 47%|████▋     | 876/1875 [2:16:02<2:28:29,  8.92s/it]
 47%|████▋     | 877/1875 [2:16:11<2:27:11,  8.85s/it]
 47%|████▋     | 878/1875 [2:16:20<2:27:20,  8.87s/it]
 47%|████▋     | 879/1875 [2:16:29<2:26:38,  8.83s/it]
 47%|████▋     | 880/1875 [2:16:37<2:26:04,  8.81s/it]
 47%|████▋     | 881/1875 [2:16:46<2:26:13,  8.83s/it]
 47%|████▋     | 882/1875 [2:16:55<2:26:06,  8.83s/it]
 47%|████▋     | 883/1875 [2:17:04<2:26:43,  8.87s/it]
 47%|████▋     | 884/1875 [2:17:13<2:25:44,  8.82s/it]
 47%|████▋     | 885/1875 [2:17:22<2:25:42,  8.83s/it]
 47%|████▋     | 886/1875 [2:17:31<2:27:37,  8.96s/it]
 47%|████▋     | 887/1875 [2:17:40<2:26:37,  8.90s/it]
 47%|████▋     | 888/1875 [2:17:49<2:26:07,  8.88s/it]
 47%|████▋     | 889/1875 [2:17:58<2:26:11,  8.90s/it]
 47%|████▋     | 890/1875 [2:18:06<2:25:32,  8.87s/it]
 48%|████▊     | 891/1875 [2:18:15<2:25:36,  8.88s/it]
 48%|████▊     | 892/1875 [2:18:24<2:24:50,  8.84s/it]
 48%|████▊     | 893/1875 [2:18:33<2:23:46,  8.79s/it]
 48%|████▊     | 894/1875 [2:18:41<2:23:44,  8.79s/it]
 48%|████▊     | 895/1875 [2:18:50<2:22:37,  8.73s/it]
 48%|████▊     | 896/1875 [2:18:59<2:23:39,  8.80s/it]
 48%|████▊     | 897/1875 [2:19:08<2:24:08,  8.84s/it]
 48%|████▊     | 898/1875 [2:19:17<2:23:15,  8.80s/it]
 48%|████▊     | 899/1875 [2:19:25<2:22:44,  8.77s/it]
 48%|████▊     | 900/1875 [2:19:34<2:23:18,  8.82s/it]
                                                      
{'loss': 1.3008, 'grad_norm': 2.8727614375772483, 'learning_rate': 1.1138041222423177e-05, 'epoch': 0.48}

 48%|████▊     | 900/1875 [2:19:34<2:23:18,  8.82s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 48%|████▊     | 901/1875 [2:20:07<4:20:44, 16.06s/it]
 48%|████▊     | 902/1875 [2:20:16<3:44:55, 13.87s/it]
 48%|████▊     | 903/1875 [2:20:25<3:19:20, 12.31s/it]
 48%|████▊     | 904/1875 [2:20:33<3:02:11, 11.26s/it]
 48%|████▊     | 905/1875 [2:20:42<2:50:04, 10.52s/it]
 48%|████▊     | 906/1875 [2:20:51<2:42:35, 10.07s/it]
 48%|████▊     | 907/1875 [2:21:00<2:37:12,  9.74s/it]
 48%|████▊     | 908/1875 [2:21:09<2:32:46,  9.48s/it]
 48%|████▊     | 909/1875 [2:21:18<2:28:42,  9.24s/it]
 49%|████▊     | 910/1875 [2:21:27<2:28:13,  9.22s/it]
 49%|████▊     | 911/1875 [2:21:36<2:25:33,  9.06s/it]
 49%|████▊     | 912/1875 [2:21:44<2:24:08,  8.98s/it]
 49%|████▊     | 913/1875 [2:21:53<2:23:22,  8.94s/it]
 49%|████▊     | 914/1875 [2:22:02<2:22:06,  8.87s/it]
 49%|████▉     | 915/1875 [2:22:11<2:21:31,  8.85s/it]
 49%|████▉     | 916/1875 [2:22:20<2:21:11,  8.83s/it]
 49%|████▉     | 917/1875 [2:22:29<2:22:18,  8.91s/it]
 49%|████▉     | 918/1875 [2:22:37<2:20:29,  8.81s/it]
 49%|████▉     | 919/1875 [2:22:46<2:19:47,  8.77s/it]
 49%|████▉     | 920/1875 [2:22:55<2:20:50,  8.85s/it]
 49%|████▉     | 921/1875 [2:23:04<2:21:01,  8.87s/it]
 49%|████▉     | 922/1875 [2:23:13<2:20:37,  8.85s/it]
 49%|████▉     | 923/1875 [2:23:22<2:20:55,  8.88s/it]
 49%|████▉     | 924/1875 [2:23:31<2:21:34,  8.93s/it]
 49%|████▉     | 925/1875 [2:23:39<2:20:27,  8.87s/it]
 49%|████▉     | 926/1875 [2:23:49<2:21:12,  8.93s/it]
 49%|████▉     | 927/1875 [2:23:58<2:21:35,  8.96s/it]
 49%|████▉     | 928/1875 [2:24:07<2:21:59,  9.00s/it]
 50%|████▉     | 929/1875 [2:24:16<2:22:29,  9.04s/it]
 50%|████▉     | 930/1875 [2:24:25<2:21:18,  8.97s/it]
 50%|████▉     | 931/1875 [2:24:34<2:21:12,  8.97s/it]
 50%|████▉     | 932/1875 [2:24:42<2:20:36,  8.95s/it]
 50%|████▉     | 933/1875 [2:24:51<2:20:04,  8.92s/it]
 50%|████▉     | 934/1875 [2:25:00<2:19:36,  8.90s/it]
 50%|████▉     | 935/1875 [2:25:09<2:19:00,  8.87s/it]
 50%|████▉     | 936/1875 [2:25:18<2:18:45,  8.87s/it]
 50%|████▉     | 937/1875 [2:25:27<2:19:04,  8.90s/it]
 50%|█████     | 938/1875 [2:25:36<2:18:32,  8.87s/it]
 50%|█████     | 939/1875 [2:25:44<2:16:59,  8.78s/it]
 50%|█████     | 940/1875 [2:25:53<2:17:11,  8.80s/it]
 50%|█████     | 941/1875 [2:26:02<2:17:50,  8.85s/it]
 50%|█████     | 942/1875 [2:26:11<2:17:54,  8.87s/it]
 50%|█████     | 943/1875 [2:26:20<2:17:17,  8.84s/it]
 50%|█████     | 944/1875 [2:26:29<2:18:28,  8.92s/it]
 50%|█████     | 945/1875 [2:26:38<2:18:12,  8.92s/it]
 50%|█████     | 946/1875 [2:26:46<2:17:23,  8.87s/it]
 51%|█████     | 947/1875 [2:26:56<2:18:20,  8.94s/it]
 51%|█████     | 948/1875 [2:27:05<2:18:35,  8.97s/it]
 51%|█████     | 949/1875 [2:27:13<2:17:56,  8.94s/it]
 51%|█████     | 950/1875 [2:27:22<2:16:55,  8.88s/it]
                                                      
{'loss': 1.2804, 'grad_norm': 3.173456281667334, 'learning_rate': 1.0276452576559878e-05, 'epoch': 0.51}

 51%|█████     | 950/1875 [2:27:22<2:16:55,  8.88s/it]
 51%|█████     | 951/1875 [2:27:31<2:17:42,  8.94s/it]
 51%|█████     | 952/1875 [2:27:40<2:17:03,  8.91s/it]
 51%|█████     | 953/1875 [2:27:49<2:17:25,  8.94s/it]
 51%|█████     | 954/1875 [2:27:58<2:17:34,  8.96s/it]
 51%|█████     | 955/1875 [2:28:07<2:16:08,  8.88s/it]
 51%|█████     | 956/1875 [2:28:16<2:15:36,  8.85s/it]
 51%|█████     | 957/1875 [2:28:25<2:17:26,  8.98s/it]
 51%|█████     | 958/1875 [2:28:34<2:16:20,  8.92s/it]
 51%|█████     | 959/1875 [2:28:43<2:16:36,  8.95s/it]
 51%|█████     | 960/1875 [2:28:51<2:15:10,  8.86s/it]
 51%|█████▏    | 961/1875 [2:29:00<2:14:14,  8.81s/it]
 51%|█████▏    | 962/1875 [2:29:09<2:13:59,  8.81s/it]
 51%|█████▏    | 963/1875 [2:29:17<2:13:03,  8.75s/it]
 51%|█████▏    | 964/1875 [2:29:26<2:13:55,  8.82s/it]
 51%|█████▏    | 965/1875 [2:29:35<2:14:15,  8.85s/it]
 52%|█████▏    | 966/1875 [2:29:44<2:14:00,  8.84s/it]
 52%|█████▏    | 967/1875 [2:29:53<2:13:15,  8.81s/it]
 52%|█████▏    | 968/1875 [2:30:02<2:14:00,  8.87s/it]
 52%|█████▏    | 969/1875 [2:30:11<2:13:26,  8.84s/it]
 52%|█████▏    | 970/1875 [2:30:19<2:12:12,  8.77s/it]
 52%|█████▏    | 971/1875 [2:30:28<2:11:45,  8.75s/it]
 52%|█████▏    | 972/1875 [2:30:37<2:11:54,  8.76s/it]
 52%|█████▏    | 973/1875 [2:30:46<2:12:35,  8.82s/it]
 52%|█████▏    | 974/1875 [2:30:55<2:12:22,  8.82s/it]
 52%|█████▏    | 975/1875 [2:31:03<2:12:18,  8.82s/it]
 52%|█████▏    | 976/1875 [2:31:12<2:12:50,  8.87s/it]
 52%|█████▏    | 977/1875 [2:31:21<2:12:16,  8.84s/it]Error in loading 145375 of [gpt4v-dataset/images/gpt_v1528.png] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v1528.png'], retrying...

 52%|█████▏    | 978/1875 [2:31:30<2:13:59,  8.96s/it]
 52%|█████▏    | 979/1875 [2:31:39<2:13:43,  8.96s/it]
 52%|█████▏    | 980/1875 [2:31:48<2:13:22,  8.94s/it]
 52%|█████▏    | 981/1875 [2:31:57<2:13:30,  8.96s/it]
 52%|█████▏    | 982/1875 [2:32:06<2:14:22,  9.03s/it]
 52%|█████▏    | 983/1875 [2:32:15<2:13:58,  9.01s/it]
 52%|█████▏    | 984/1875 [2:32:25<2:14:30,  9.06s/it]
 53%|█████▎    | 985/1875 [2:32:33<2:13:13,  8.98s/it]
 53%|█████▎    | 986/1875 [2:32:43<2:14:36,  9.08s/it]
 53%|█████▎    | 987/1875 [2:32:52<2:14:25,  9.08s/it]
 53%|█████▎    | 988/1875 [2:33:01<2:13:23,  9.02s/it]
 53%|█████▎    | 989/1875 [2:33:10<2:14:17,  9.09s/it]
 53%|█████▎    | 990/1875 [2:33:19<2:15:44,  9.20s/it]
 53%|█████▎    | 991/1875 [2:33:29<2:17:35,  9.34s/it]
 53%|█████▎    | 992/1875 [2:33:38<2:17:37,  9.35s/it]
 53%|█████▎    | 993/1875 [2:33:47<2:15:37,  9.23s/it]
 53%|█████▎    | 994/1875 [2:33:56<2:14:06,  9.13s/it]
 53%|█████▎    | 995/1875 [2:34:06<2:14:33,  9.17s/it]
 53%|█████▎    | 996/1875 [2:34:15<2:15:42,  9.26s/it]
 53%|█████▎    | 997/1875 [2:34:24<2:14:16,  9.18s/it]
 53%|█████▎    | 998/1875 [2:34:33<2:12:17,  9.05s/it]
 53%|█████▎    | 999/1875 [2:34:42<2:12:26,  9.07s/it]
 53%|█████▎    | 1000/1875 [2:34:51<2:12:54,  9.11s/it]
                                                       
{'loss': 1.2748, 'grad_norm': 2.677252128390076, 'learning_rate': 9.412801390409496e-06, 'epoch': 0.53}

 53%|█████▎    | 1000/1875 [2:34:51<2:12:54,  9.11s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 53%|█████▎    | 1001/1875 [2:35:32<4:29:40, 18.51s/it]
 53%|█████▎    | 1002/1875 [2:35:41<3:49:08, 15.75s/it]
 53%|█████▎    | 1003/1875 [2:35:50<3:18:42, 13.67s/it]
 54%|█████▎    | 1004/1875 [2:35:58<2:57:21, 12.22s/it]
 54%|█████▎    | 1005/1875 [2:36:07<2:43:13, 11.26s/it]
 54%|█████▎    | 1006/1875 [2:36:16<2:32:16, 10.51s/it]
 54%|█████▎    | 1007/1875 [2:36:25<2:23:51,  9.94s/it]
 54%|█████▍    | 1008/1875 [2:36:34<2:18:44,  9.60s/it]
 54%|█████▍    | 1009/1875 [2:36:43<2:15:25,  9.38s/it]
 54%|█████▍    | 1010/1875 [2:36:52<2:13:27,  9.26s/it]
 54%|█████▍    | 1011/1875 [2:37:00<2:11:52,  9.16s/it]
 54%|█████▍    | 1012/1875 [2:37:09<2:09:14,  8.99s/it]
 54%|█████▍    | 1013/1875 [2:37:18<2:09:36,  9.02s/it]
 54%|█████▍    | 1014/1875 [2:37:27<2:08:52,  8.98s/it]
 54%|█████▍    | 1015/1875 [2:37:36<2:07:50,  8.92s/it]
 54%|█████▍    | 1016/1875 [2:37:45<2:07:18,  8.89s/it]
 54%|█████▍    | 1017/1875 [2:37:54<2:07:14,  8.90s/it]
 54%|█████▍    | 1018/1875 [2:38:02<2:07:16,  8.91s/it]
 54%|█████▍    | 1019/1875 [2:38:11<2:06:31,  8.87s/it]
 54%|█████▍    | 1020/1875 [2:38:20<2:05:43,  8.82s/it]Error in loading 239851 of [gpt4v-dataset/images/gpt_v9683.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v9683.jpg'], retrying...

 54%|█████▍    | 1021/1875 [2:38:29<2:05:24,  8.81s/it]
 55%|█████▍    | 1022/1875 [2:38:37<2:04:50,  8.78s/it]
 55%|█████▍    | 1023/1875 [2:38:46<2:04:28,  8.77s/it]
 55%|█████▍    | 1024/1875 [2:38:55<2:04:45,  8.80s/it]
 55%|█████▍    | 1025/1875 [2:39:04<2:05:23,  8.85s/it]
 55%|█████▍    | 1026/1875 [2:39:13<2:05:12,  8.85s/it]
 55%|█████▍    | 1027/1875 [2:39:22<2:06:03,  8.92s/it]
 55%|█████▍    | 1028/1875 [2:39:31<2:04:57,  8.85s/it]
 55%|█████▍    | 1029/1875 [2:39:40<2:05:19,  8.89s/it]
 55%|█████▍    | 1030/1875 [2:39:49<2:06:06,  8.95s/it]
 55%|█████▍    | 1031/1875 [2:39:57<2:04:59,  8.89s/it]
 55%|█████▌    | 1032/1875 [2:40:06<2:05:23,  8.92s/it]
 55%|█████▌    | 1033/1875 [2:40:15<2:03:56,  8.83s/it]
 55%|█████▌    | 1034/1875 [2:40:25<2:06:36,  9.03s/it]
 55%|█████▌    | 1035/1875 [2:40:33<2:05:51,  8.99s/it]
 55%|█████▌    | 1036/1875 [2:40:42<2:05:00,  8.94s/it]
 55%|█████▌    | 1037/1875 [2:40:51<2:03:53,  8.87s/it]
 55%|█████▌    | 1038/1875 [2:41:00<2:04:18,  8.91s/it]
 55%|█████▌    | 1039/1875 [2:41:09<2:04:12,  8.91s/it]
 55%|█████▌    | 1040/1875 [2:41:18<2:03:54,  8.90s/it]
 56%|█████▌    | 1041/1875 [2:41:27<2:03:29,  8.88s/it]
 56%|█████▌    | 1042/1875 [2:41:36<2:03:32,  8.90s/it]
 56%|█████▌    | 1043/1875 [2:41:44<2:03:05,  8.88s/it]
 56%|█████▌    | 1044/1875 [2:41:53<2:03:34,  8.92s/it]
 56%|█████▌    | 1045/1875 [2:42:02<2:03:06,  8.90s/it]
 56%|█████▌    | 1046/1875 [2:42:11<2:02:41,  8.88s/it]
 56%|█████▌    | 1047/1875 [2:42:20<2:02:18,  8.86s/it]
 56%|█████▌    | 1048/1875 [2:42:29<2:04:30,  9.03s/it]
 56%|█████▌    | 1049/1875 [2:42:38<2:04:27,  9.04s/it]
 56%|█████▌    | 1050/1875 [2:42:48<2:04:38,  9.07s/it]
                                                       
{'loss': 1.2741, 'grad_norm': 2.69305840672548, 'learning_rate': 8.553531139332583e-06, 'epoch': 0.56}

 56%|█████▌    | 1050/1875 [2:42:48<2:04:38,  9.07s/it]
 56%|█████▌    | 1051/1875 [2:42:56<2:03:09,  8.97s/it]
 56%|█████▌    | 1052/1875 [2:43:05<2:02:47,  8.95s/it]
 56%|█████▌    | 1053/1875 [2:43:14<2:01:34,  8.87s/it]
 56%|█████▌    | 1054/1875 [2:43:23<2:00:54,  8.84s/it]
 56%|█████▋    | 1055/1875 [2:43:31<2:00:31,  8.82s/it]
 56%|█████▋    | 1056/1875 [2:43:40<2:00:34,  8.83s/it]
 56%|█████▋    | 1057/1875 [2:43:49<2:01:09,  8.89s/it]Error in loading 46095 of [gpt4v-dataset/images/gpt_v4773.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v4773.jpg'], retrying...

 56%|█████▋    | 1058/1875 [2:43:59<2:02:43,  9.01s/it]
 56%|█████▋    | 1059/1875 [2:44:07<2:01:58,  8.97s/it]
 57%|█████▋    | 1060/1875 [2:44:17<2:02:09,  8.99s/it]
 57%|█████▋    | 1061/1875 [2:44:25<2:01:36,  8.96s/it]
 57%|█████▋    | 1062/1875 [2:44:35<2:02:28,  9.04s/it]
 57%|█████▋    | 1063/1875 [2:44:44<2:03:43,  9.14s/it]
 57%|█████▋    | 1064/1875 [2:44:53<2:02:12,  9.04s/it]
 57%|█████▋    | 1065/1875 [2:45:02<2:02:37,  9.08s/it]
 57%|█████▋    | 1066/1875 [2:45:11<2:01:44,  9.03s/it]
 57%|█████▋    | 1067/1875 [2:45:20<2:00:40,  8.96s/it]
 57%|█████▋    | 1068/1875 [2:45:29<2:01:52,  9.06s/it]
 57%|█████▋    | 1069/1875 [2:45:38<2:01:43,  9.06s/it]
 57%|█████▋    | 1070/1875 [2:45:47<2:02:45,  9.15s/it]
 57%|█████▋    | 1071/1875 [2:45:57<2:03:04,  9.18s/it]
 57%|█████▋    | 1072/1875 [2:46:06<2:03:50,  9.25s/it]Error in loading 190637 of [gpt4v-dataset/images/gpt_v9332.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v9332.jpg'], retrying...

 57%|█████▋    | 1073/1875 [2:46:15<2:03:32,  9.24s/it]
 57%|█████▋    | 1074/1875 [2:46:24<2:01:45,  9.12s/it]
 57%|█████▋    | 1075/1875 [2:46:33<2:01:01,  9.08s/it]
 57%|█████▋    | 1076/1875 [2:46:42<2:01:01,  9.09s/it]
 57%|█████▋    | 1077/1875 [2:46:51<1:59:36,  8.99s/it]
 57%|█████▋    | 1078/1875 [2:47:00<1:59:35,  9.00s/it]
 58%|█████▊    | 1079/1875 [2:47:09<1:59:26,  9.00s/it]
 58%|█████▊    | 1080/1875 [2:47:18<2:00:08,  9.07s/it]
 58%|█████▊    | 1081/1875 [2:47:27<1:59:50,  9.06s/it]
 58%|█████▊    | 1082/1875 [2:47:36<1:59:48,  9.06s/it]
 58%|█████▊    | 1083/1875 [2:47:45<1:59:04,  9.02s/it]
 58%|█████▊    | 1084/1875 [2:47:54<1:58:33,  8.99s/it]
 58%|█████▊    | 1085/1875 [2:48:04<2:00:34,  9.16s/it]
 58%|█████▊    | 1086/1875 [2:48:13<2:00:12,  9.14s/it]
 58%|█████▊    | 1087/1875 [2:48:22<1:59:02,  9.06s/it]
 58%|█████▊    | 1088/1875 [2:48:31<1:58:40,  9.05s/it]
 58%|█████▊    | 1089/1875 [2:48:40<1:58:28,  9.04s/it]
 58%|█████▊    | 1090/1875 [2:48:49<1:58:28,  9.06s/it]
 58%|█████▊    | 1091/1875 [2:48:58<1:58:24,  9.06s/it]
 58%|█████▊    | 1092/1875 [2:49:07<1:57:37,  9.01s/it]
 58%|█████▊    | 1093/1875 [2:49:16<1:57:12,  8.99s/it]
 58%|█████▊    | 1094/1875 [2:49:25<1:56:21,  8.94s/it]
 58%|█████▊    | 1095/1875 [2:49:34<1:57:07,  9.01s/it]
 58%|█████▊    | 1096/1875 [2:49:43<1:57:18,  9.03s/it]
 59%|█████▊    | 1097/1875 [2:49:52<1:56:52,  9.01s/it]
 59%|█████▊    | 1098/1875 [2:50:01<1:55:41,  8.93s/it]
 59%|█████▊    | 1099/1875 [2:50:10<1:56:31,  9.01s/it]
 59%|█████▊    | 1100/1875 [2:50:19<1:56:52,  9.05s/it]
                                                       
{'loss': 1.2687, 'grad_norm': 2.90220089143835, 'learning_rate': 7.705052613680212e-06, 'epoch': 0.59}

 59%|█████▊    | 1100/1875 [2:50:19<1:56:52,  9.05s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 59%|█████▊    | 1101/1875 [2:50:53<3:32:30, 16.47s/it]
 59%|█████▉    | 1102/1875 [2:51:02<3:03:17, 14.23s/it]
 59%|█████▉    | 1103/1875 [2:51:11<2:43:25, 12.70s/it]
 59%|█████▉    | 1104/1875 [2:51:20<2:30:51, 11.74s/it]
 59%|█████▉    | 1105/1875 [2:51:29<2:19:18, 10.85s/it]
 59%|█████▉    | 1106/1875 [2:51:38<2:12:34, 10.34s/it]
 59%|█████▉    | 1107/1875 [2:51:47<2:07:16,  9.94s/it]
 59%|█████▉    | 1108/1875 [2:51:57<2:04:41,  9.75s/it]
 59%|█████▉    | 1109/1875 [2:52:06<2:01:34,  9.52s/it]
 59%|█████▉    | 1110/1875 [2:52:15<1:59:34,  9.38s/it]
 59%|█████▉    | 1111/1875 [2:52:24<1:57:46,  9.25s/it]
 59%|█████▉    | 1112/1875 [2:52:33<1:56:29,  9.16s/it]
 59%|█████▉    | 1113/1875 [2:52:41<1:55:18,  9.08s/it]
 59%|█████▉    | 1114/1875 [2:52:50<1:54:23,  9.02s/it]
 59%|█████▉    | 1115/1875 [2:52:59<1:54:15,  9.02s/it]
 60%|█████▉    | 1116/1875 [2:53:08<1:53:27,  8.97s/it]
 60%|█████▉    | 1117/1875 [2:53:17<1:53:02,  8.95s/it]
 60%|█████▉    | 1118/1875 [2:53:26<1:53:40,  9.01s/it]
 60%|█████▉    | 1119/1875 [2:53:35<1:53:40,  9.02s/it]
 60%|█████▉    | 1120/1875 [2:53:44<1:53:24,  9.01s/it]
 60%|█████▉    | 1121/1875 [2:53:53<1:52:58,  8.99s/it]
 60%|█████▉    | 1122/1875 [2:54:03<1:56:50,  9.31s/it]
 60%|█████▉    | 1123/1875 [2:54:12<1:55:35,  9.22s/it]
 60%|█████▉    | 1124/1875 [2:54:21<1:55:10,  9.20s/it]
 60%|██████    | 1125/1875 [2:54:31<1:55:03,  9.21s/it]
 60%|██████    | 1126/1875 [2:54:40<1:55:27,  9.25s/it]
 60%|██████    | 1127/1875 [2:54:49<1:54:21,  9.17s/it]
 60%|██████    | 1128/1875 [2:54:58<1:52:59,  9.08s/it]
 60%|██████    | 1129/1875 [2:55:07<1:52:12,  9.02s/it]
 60%|██████    | 1130/1875 [2:55:16<1:51:45,  9.00s/it]Error in loading 5436 of [gpt4v-dataset/images/gpt_v5858.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v5858.jpg'], retrying...

 60%|██████    | 1131/1875 [2:55:25<1:52:20,  9.06s/it]
 60%|██████    | 1132/1875 [2:55:34<1:52:16,  9.07s/it]
 60%|██████    | 1133/1875 [2:55:43<1:52:23,  9.09s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (2085 > 2048). Running this sequence through the model will result in indexing errors

 60%|██████    | 1134/1875 [2:55:52<1:52:12,  9.09s/it]
 61%|██████    | 1135/1875 [2:56:01<1:51:49,  9.07s/it]
 61%|██████    | 1136/1875 [2:56:11<1:52:31,  9.14s/it]
 61%|██████    | 1137/1875 [2:56:20<1:51:50,  9.09s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/PIL/Image.py:3368: DecompressionBombWarning: Image size (159222407 pixels) exceeds limit of 89478485 pixels, could be decompression bomb DOS attack.
  warnings.warn(

 61%|██████    | 1138/1875 [2:56:29<1:52:21,  9.15s/it]
 61%|██████    | 1139/1875 [2:57:12<3:57:29, 19.36s/it]
 61%|██████    | 1140/1875 [2:57:21<3:19:19, 16.27s/it]
 61%|██████    | 1141/1875 [2:57:30<2:52:22, 14.09s/it]
 61%|██████    | 1142/1875 [2:57:39<2:33:39, 12.58s/it]
 61%|██████    | 1143/1875 [2:57:48<2:20:23, 11.51s/it]
 61%|██████    | 1144/1875 [2:57:57<2:12:21, 10.86s/it]
 61%|██████    | 1145/1875 [2:58:06<2:05:07, 10.28s/it]
 61%|██████    | 1146/1875 [2:58:15<2:00:13,  9.90s/it]
 61%|██████    | 1147/1875 [2:58:24<1:56:38,  9.61s/it]
 61%|██████    | 1148/1875 [2:58:33<1:53:52,  9.40s/it]
 61%|██████▏   | 1149/1875 [2:58:42<1:51:56,  9.25s/it]
 61%|██████▏   | 1150/1875 [2:58:51<1:50:51,  9.17s/it]
                                                       
{'loss': 1.2606, 'grad_norm': 3.2505399038525686, 'learning_rate': 6.8736960895657854e-06, 'epoch': 0.61}

 61%|██████▏   | 1150/1875 [2:58:51<1:50:51,  9.17s/it]
 61%|██████▏   | 1151/1875 [2:59:00<1:51:05,  9.21s/it]
 61%|██████▏   | 1152/1875 [2:59:09<1:49:46,  9.11s/it]
 61%|██████▏   | 1153/1875 [2:59:18<1:49:02,  9.06s/it]
 62%|██████▏   | 1154/1875 [2:59:27<1:47:59,  8.99s/it]
 62%|██████▏   | 1155/1875 [2:59:36<1:48:25,  9.04s/it]
 62%|██████▏   | 1156/1875 [2:59:45<1:48:33,  9.06s/it]
 62%|██████▏   | 1157/1875 [2:59:54<1:48:23,  9.06s/it]
 62%|██████▏   | 1158/1875 [3:00:04<1:48:34,  9.09s/it]
 62%|██████▏   | 1159/1875 [3:00:12<1:47:53,  9.04s/it]
 62%|██████▏   | 1160/1875 [3:00:22<1:48:12,  9.08s/it]
 62%|██████▏   | 1161/1875 [3:00:31<1:47:52,  9.06s/it]
 62%|██████▏   | 1162/1875 [3:00:40<1:47:15,  9.03s/it]
 62%|██████▏   | 1163/1875 [3:00:48<1:46:15,  8.95s/it]
 62%|██████▏   | 1164/1875 [3:00:58<1:47:22,  9.06s/it]
 62%|██████▏   | 1165/1875 [3:01:07<1:47:37,  9.10s/it]
 62%|██████▏   | 1166/1875 [3:01:16<1:47:47,  9.12s/it]
 62%|██████▏   | 1167/1875 [3:01:25<1:47:37,  9.12s/it]
 62%|██████▏   | 1168/1875 [3:01:34<1:47:10,  9.10s/it]
 62%|██████▏   | 1169/1875 [3:01:43<1:46:34,  9.06s/it]
 62%|██████▏   | 1170/1875 [3:01:52<1:45:08,  8.95s/it]
 62%|██████▏   | 1171/1875 [3:02:01<1:44:45,  8.93s/it]
 63%|██████▎   | 1172/1875 [3:02:10<1:44:26,  8.91s/it]
 63%|██████▎   | 1173/1875 [3:02:18<1:43:51,  8.88s/it]
 63%|██████▎   | 1174/1875 [3:02:27<1:43:48,  8.89s/it]
 63%|██████▎   | 1175/1875 [3:02:36<1:44:17,  8.94s/it]
 63%|██████▎   | 1176/1875 [3:02:45<1:43:56,  8.92s/it]
 63%|██████▎   | 1177/1875 [3:02:54<1:43:30,  8.90s/it]
 63%|██████▎   | 1178/1875 [3:03:03<1:42:35,  8.83s/it]
 63%|██████▎   | 1179/1875 [3:03:12<1:42:32,  8.84s/it]
 63%|██████▎   | 1180/1875 [3:03:21<1:43:12,  8.91s/it]
 63%|██████▎   | 1181/1875 [3:03:29<1:42:29,  8.86s/it]
 63%|██████▎   | 1182/1875 [3:03:39<1:43:02,  8.92s/it]
 63%|██████▎   | 1183/1875 [3:03:48<1:43:43,  8.99s/it]
 63%|██████▎   | 1184/1875 [3:03:57<1:43:29,  8.99s/it]
 63%|██████▎   | 1185/1875 [3:04:06<1:43:23,  8.99s/it]
 63%|██████▎   | 1186/1875 [3:04:15<1:43:07,  8.98s/it]
 63%|██████▎   | 1187/1875 [3:04:24<1:43:30,  9.03s/it]
 63%|██████▎   | 1188/1875 [3:04:33<1:42:55,  8.99s/it]
 63%|██████▎   | 1189/1875 [3:04:41<1:41:50,  8.91s/it]
 63%|██████▎   | 1190/1875 [3:04:51<1:42:24,  8.97s/it]
 64%|██████▎   | 1191/1875 [3:05:00<1:42:50,  9.02s/it]
 64%|██████▎   | 1192/1875 [3:05:09<1:43:02,  9.05s/it]
 64%|██████▎   | 1193/1875 [3:05:18<1:43:00,  9.06s/it]
 64%|██████▎   | 1194/1875 [3:05:27<1:43:09,  9.09s/it]
 64%|██████▎   | 1195/1875 [3:05:36<1:42:00,  9.00s/it]
 64%|██████▍   | 1196/1875 [3:05:45<1:41:31,  8.97s/it]
 64%|██████▍   | 1197/1875 [3:05:54<1:41:00,  8.94s/it]
 64%|██████▍   | 1198/1875 [3:06:02<1:40:34,  8.91s/it]
 64%|██████▍   | 1199/1875 [3:06:11<1:40:01,  8.88s/it]
 64%|██████▍   | 1200/1875 [3:06:20<1:40:43,  8.95s/it]
                                                       
{'loss': 1.255, 'grad_norm': 3.2488395729473267, 'learning_rate': 6.065664100332478e-06, 'epoch': 0.64}

 64%|██████▍   | 1200/1875 [3:06:20<1:40:43,  8.95s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 64%|██████▍   | 1201/1875 [3:06:53<3:00:30, 16.07s/it]
 64%|██████▍   | 1202/1875 [3:07:02<2:37:28, 14.04s/it]
 64%|██████▍   | 1203/1875 [3:07:12<2:22:09, 12.69s/it]
 64%|██████▍   | 1204/1875 [3:07:22<2:11:53, 11.79s/it]
 64%|██████▍   | 1205/1875 [3:07:30<2:02:02, 10.93s/it]
 64%|██████▍   | 1206/1875 [3:07:39<1:54:33, 10.27s/it]
 64%|██████▍   | 1207/1875 [3:07:48<1:50:38,  9.94s/it]
 64%|██████▍   | 1208/1875 [3:07:57<1:46:47,  9.61s/it]
 64%|██████▍   | 1209/1875 [3:08:06<1:43:43,  9.34s/it]
 65%|██████▍   | 1210/1875 [3:08:15<1:41:30,  9.16s/it]
 65%|██████▍   | 1211/1875 [3:08:23<1:39:59,  9.04s/it]
 65%|██████▍   | 1212/1875 [3:08:33<1:40:52,  9.13s/it]
 65%|██████▍   | 1213/1875 [3:08:42<1:40:34,  9.12s/it]
 65%|██████▍   | 1214/1875 [3:08:52<1:42:17,  9.29s/it]
 65%|██████▍   | 1215/1875 [3:09:01<1:41:18,  9.21s/it]
 65%|██████▍   | 1216/1875 [3:09:10<1:40:29,  9.15s/it]
 65%|██████▍   | 1217/1875 [3:09:18<1:38:55,  9.02s/it]
 65%|██████▍   | 1218/1875 [3:09:27<1:38:27,  8.99s/it]
 65%|██████▌   | 1219/1875 [3:09:37<1:39:25,  9.09s/it]
 65%|██████▌   | 1220/1875 [3:09:45<1:37:58,  8.97s/it]
 65%|██████▌   | 1221/1875 [3:09:55<1:40:02,  9.18s/it]
 65%|██████▌   | 1222/1875 [3:10:04<1:39:41,  9.16s/it]
 65%|██████▌   | 1223/1875 [3:10:13<1:38:26,  9.06s/it]
 65%|██████▌   | 1224/1875 [3:10:21<1:36:51,  8.93s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/PIL/Image.py:1056: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  warnings.warn(

 65%|██████▌   | 1225/1875 [3:10:30<1:35:55,  8.85s/it]
 65%|██████▌   | 1226/1875 [3:10:39<1:35:32,  8.83s/it]
 65%|██████▌   | 1227/1875 [3:10:48<1:36:28,  8.93s/it]
 65%|██████▌   | 1228/1875 [3:10:57<1:36:00,  8.90s/it]
 66%|██████▌   | 1229/1875 [3:11:06<1:35:15,  8.85s/it]
 66%|██████▌   | 1230/1875 [3:11:14<1:35:03,  8.84s/it]
 66%|██████▌   | 1231/1875 [3:11:23<1:34:46,  8.83s/it]
 66%|██████▌   | 1232/1875 [3:11:32<1:35:01,  8.87s/it]
 66%|██████▌   | 1233/1875 [3:11:41<1:34:58,  8.88s/it]
 66%|██████▌   | 1234/1875 [3:11:50<1:35:35,  8.95s/it]
 66%|██████▌   | 1235/1875 [3:11:59<1:35:29,  8.95s/it]
 66%|██████▌   | 1236/1875 [3:12:08<1:36:14,  9.04s/it]
 66%|██████▌   | 1237/1875 [3:12:18<1:36:52,  9.11s/it]
 66%|██████▌   | 1238/1875 [3:12:27<1:35:38,  9.01s/it]
 66%|██████▌   | 1239/1875 [3:12:35<1:35:17,  8.99s/it]
 66%|██████▌   | 1240/1875 [3:12:44<1:35:05,  8.99s/it]
 66%|██████▌   | 1241/1875 [3:12:53<1:34:38,  8.96s/it]
 66%|██████▌   | 1242/1875 [3:13:02<1:33:46,  8.89s/it]
 66%|██████▋   | 1243/1875 [3:13:11<1:33:41,  8.89s/it]
 66%|██████▋   | 1244/1875 [3:13:20<1:33:28,  8.89s/it]
 66%|██████▋   | 1245/1875 [3:13:29<1:33:54,  8.94s/it]
 66%|██████▋   | 1246/1875 [3:13:38<1:33:50,  8.95s/it]
 67%|██████▋   | 1247/1875 [3:13:47<1:34:20,  9.01s/it]
 67%|██████▋   | 1248/1875 [3:13:56<1:34:46,  9.07s/it]
 67%|██████▋   | 1249/1875 [3:14:05<1:33:31,  8.96s/it]
 67%|██████▋   | 1250/1875 [3:14:14<1:33:59,  9.02s/it]
                                                       
{'loss': 1.2525, 'grad_norm': 3.5422848125586217, 'learning_rate': 5.286985161076029e-06, 'epoch': 0.67}

 67%|██████▋   | 1250/1875 [3:14:14<1:33:59,  9.02s/it]
 67%|██████▋   | 1251/1875 [3:14:23<1:33:12,  8.96s/it]
 67%|██████▋   | 1252/1875 [3:14:32<1:32:19,  8.89s/it]
 67%|██████▋   | 1253/1875 [3:14:40<1:31:27,  8.82s/it]
 67%|██████▋   | 1254/1875 [3:14:49<1:30:58,  8.79s/it]
 67%|██████▋   | 1255/1875 [3:14:58<1:30:22,  8.75s/it]
 67%|██████▋   | 1256/1875 [3:15:06<1:30:03,  8.73s/it]
 67%|██████▋   | 1257/1875 [3:15:16<1:32:40,  9.00s/it]
 67%|██████▋   | 1258/1875 [3:15:25<1:31:58,  8.94s/it]
 67%|██████▋   | 1259/1875 [3:15:34<1:31:34,  8.92s/it]
 67%|██████▋   | 1260/1875 [3:15:43<1:31:54,  8.97s/it]
 67%|██████▋   | 1261/1875 [3:15:55<1:41:36,  9.93s/it]
 67%|██████▋   | 1262/1875 [3:16:05<1:41:15,  9.91s/it]
 67%|██████▋   | 1263/1875 [3:16:15<1:42:05, 10.01s/it]
 67%|██████▋   | 1264/1875 [3:16:25<1:41:14,  9.94s/it]
 67%|██████▋   | 1265/1875 [3:16:35<1:41:58, 10.03s/it]
 68%|██████▊   | 1266/1875 [3:16:45<1:41:05,  9.96s/it]
 68%|██████▊   | 1267/1875 [3:16:54<1:39:37,  9.83s/it]
 68%|██████▊   | 1268/1875 [3:17:03<1:35:44,  9.46s/it]
 68%|██████▊   | 1269/1875 [3:17:12<1:33:23,  9.25s/it]
 68%|██████▊   | 1270/1875 [3:17:21<1:33:00,  9.22s/it]
 68%|██████▊   | 1271/1875 [3:17:30<1:32:01,  9.14s/it]Error in loading 200323 of [gpt4v-dataset/images/gpt_v6661.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v6661.jpg'], retrying...

 68%|██████▊   | 1272/1875 [3:17:40<1:34:23,  9.39s/it]
 68%|██████▊   | 1273/1875 [3:17:52<1:44:08, 10.38s/it]
 68%|██████▊   | 1274/1875 [3:18:05<1:49:21, 10.92s/it]
 68%|██████▊   | 1275/1875 [3:18:13<1:42:42, 10.27s/it]
 68%|██████▊   | 1276/1875 [3:18:23<1:39:01,  9.92s/it]
 68%|██████▊   | 1277/1875 [3:18:32<1:38:28,  9.88s/it]
 68%|██████▊   | 1278/1875 [3:18:42<1:37:59,  9.85s/it]
 68%|██████▊   | 1279/1875 [3:18:51<1:35:32,  9.62s/it]
 68%|██████▊   | 1280/1875 [3:19:01<1:35:11,  9.60s/it]
 68%|██████▊   | 1281/1875 [3:19:11<1:35:37,  9.66s/it]
 68%|██████▊   | 1282/1875 [3:19:20<1:34:58,  9.61s/it]
 68%|██████▊   | 1283/1875 [3:19:29<1:32:26,  9.37s/it]
 68%|██████▊   | 1284/1875 [3:19:38<1:31:36,  9.30s/it]
 69%|██████▊   | 1285/1875 [3:19:47<1:30:22,  9.19s/it]
 69%|██████▊   | 1286/1875 [3:19:57<1:32:47,  9.45s/it]
 69%|██████▊   | 1287/1875 [3:20:08<1:38:17, 10.03s/it]
 69%|██████▊   | 1288/1875 [3:20:21<1:45:16, 10.76s/it]
 69%|██████▊   | 1289/1875 [3:21:07<3:28:18, 21.33s/it]Error in loading 183539 of [gpt4v-dataset/images/gpt_v304.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v304.jpg'], retrying...
Error in loading 105835 of [gpt4v-dataset/images/gpt_v4863.png] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v4863.png'], retrying...

 69%|██████▉   | 1290/1875 [3:21:16<2:51:48, 17.62s/it]
 69%|██████▉   | 1291/1875 [3:21:25<2:26:44, 15.08s/it]
 69%|██████▉   | 1292/1875 [3:21:35<2:12:04, 13.59s/it]
 69%|██████▉   | 1293/1875 [3:21:48<2:09:00, 13.30s/it]
 69%|██████▉   | 1294/1875 [3:21:57<1:58:08, 12.20s/it]
 69%|██████▉   | 1295/1875 [3:22:06<1:48:41, 11.24s/it]
 69%|██████▉   | 1296/1875 [3:22:15<1:42:23, 10.61s/it]
 69%|██████▉   | 1297/1875 [3:22:25<1:38:01, 10.18s/it]
 69%|██████▉   | 1298/1875 [3:22:33<1:34:05,  9.78s/it]
 69%|██████▉   | 1299/1875 [3:22:42<1:31:19,  9.51s/it]
 69%|██████▉   | 1300/1875 [3:22:51<1:29:00,  9.29s/it]
                                                       
{'loss': 1.2336, 'grad_norm': 2.9867696745956707, 'learning_rate': 4.543468791472131e-06, 'epoch': 0.69}

 69%|██████▉   | 1300/1875 [3:22:51<1:29:00,  9.29s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 69%|██████▉   | 1301/1875 [3:23:24<2:36:29, 16.36s/it]
 69%|██████▉   | 1302/1875 [3:23:33<2:15:36, 14.20s/it]
 69%|██████▉   | 1303/1875 [3:23:42<2:00:22, 12.63s/it]
 70%|██████▉   | 1304/1875 [3:23:51<1:50:32, 11.62s/it]Error in loading 116241 of [gpt4v-dataset/images/gpt_v6977.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v6977.jpg'], retrying...

 70%|██████▉   | 1305/1875 [3:24:00<1:42:28, 10.79s/it]
 70%|██████▉   | 1306/1875 [3:24:09<1:37:52, 10.32s/it]
 70%|██████▉   | 1307/1875 [3:24:19<1:36:41, 10.21s/it]
 70%|██████▉   | 1308/1875 [3:24:29<1:35:35, 10.12s/it]
 70%|██████▉   | 1309/1875 [3:24:40<1:37:17, 10.31s/it]
 70%|██████▉   | 1310/1875 [3:24:51<1:39:26, 10.56s/it]
 70%|██████▉   | 1311/1875 [3:25:01<1:36:33, 10.27s/it]
 70%|██████▉   | 1312/1875 [3:25:10<1:33:46,  9.99s/it]
 70%|███████   | 1313/1875 [3:25:20<1:32:17,  9.85s/it]
 70%|███████   | 1314/1875 [3:25:29<1:29:45,  9.60s/it]
 70%|███████   | 1315/1875 [3:25:38<1:29:02,  9.54s/it]
 70%|███████   | 1316/1875 [3:25:48<1:28:54,  9.54s/it]
 70%|███████   | 1317/1875 [3:25:57<1:28:04,  9.47s/it]
 70%|███████   | 1318/1875 [3:26:06<1:27:01,  9.37s/it]
 70%|███████   | 1319/1875 [3:26:15<1:25:56,  9.27s/it]
 70%|███████   | 1320/1875 [3:26:24<1:25:15,  9.22s/it]
 70%|███████   | 1321/1875 [3:26:34<1:25:33,  9.27s/it]
 71%|███████   | 1322/1875 [3:26:43<1:25:31,  9.28s/it]
 71%|███████   | 1323/1875 [3:26:53<1:27:50,  9.55s/it]
 71%|███████   | 1324/1875 [3:27:03<1:28:11,  9.60s/it]
 71%|███████   | 1325/1875 [3:27:12<1:28:05,  9.61s/it]
 71%|███████   | 1326/1875 [3:27:22<1:27:32,  9.57s/it]
 71%|███████   | 1327/1875 [3:27:32<1:29:00,  9.75s/it]
 71%|███████   | 1328/1875 [3:27:41<1:27:24,  9.59s/it]
 71%|███████   | 1329/1875 [3:27:51<1:28:05,  9.68s/it]
 71%|███████   | 1330/1875 [3:28:00<1:26:45,  9.55s/it]
 71%|███████   | 1331/1875 [3:28:10<1:26:13,  9.51s/it]Error in loading 130631 of [gpt4v-dataset/images/gpt_v7353.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v7353.jpg'], retrying...

 71%|███████   | 1332/1875 [3:28:19<1:24:48,  9.37s/it]
 71%|███████   | 1333/1875 [3:28:28<1:23:57,  9.29s/it]
 71%|███████   | 1334/1875 [3:28:37<1:23:48,  9.30s/it]
 71%|███████   | 1335/1875 [3:28:48<1:27:48,  9.76s/it]
 71%|███████▏  | 1336/1875 [3:28:58<1:27:43,  9.76s/it]
 71%|███████▏  | 1337/1875 [3:29:08<1:28:44,  9.90s/it]
 71%|███████▏  | 1338/1875 [3:29:18<1:27:51,  9.82s/it]
 71%|███████▏  | 1339/1875 [3:29:27<1:27:15,  9.77s/it]
 71%|███████▏  | 1340/1875 [3:29:36<1:25:15,  9.56s/it]
 72%|███████▏  | 1341/1875 [3:29:46<1:24:09,  9.46s/it]
 72%|███████▏  | 1342/1875 [3:29:55<1:24:14,  9.48s/it]
 72%|███████▏  | 1343/1875 [3:30:05<1:24:14,  9.50s/it]
 72%|███████▏  | 1344/1875 [3:30:14<1:24:32,  9.55s/it]
 72%|███████▏  | 1345/1875 [3:30:24<1:24:27,  9.56s/it]
 72%|███████▏  | 1346/1875 [3:30:33<1:23:46,  9.50s/it]
 72%|███████▏  | 1347/1875 [3:30:43<1:24:27,  9.60s/it]
 72%|███████▏  | 1348/1875 [3:30:59<1:39:22, 11.31s/it]
 72%|███████▏  | 1349/1875 [3:31:07<1:32:59, 10.61s/it]
 72%|███████▏  | 1350/1875 [3:31:17<1:29:03, 10.18s/it]
                                                       
{'loss': 1.2332, 'grad_norm': 2.673830312041119, 'learning_rate': 3.840662172471315e-06, 'epoch': 0.72}

 72%|███████▏  | 1350/1875 [3:31:17<1:29:03, 10.18s/it]
 72%|███████▏  | 1351/1875 [3:31:26<1:25:57,  9.84s/it]
 72%|███████▏  | 1352/1875 [3:31:35<1:24:23,  9.68s/it]
 72%|███████▏  | 1353/1875 [3:31:44<1:22:46,  9.51s/it]
 72%|███████▏  | 1354/1875 [3:31:53<1:21:04,  9.34s/it]
 72%|███████▏  | 1355/1875 [3:32:02<1:21:07,  9.36s/it]
 72%|███████▏  | 1356/1875 [3:32:12<1:21:59,  9.48s/it]
 72%|███████▏  | 1357/1875 [3:32:22<1:23:00,  9.62s/it]
 72%|███████▏  | 1358/1875 [3:32:31<1:21:44,  9.49s/it]
 72%|███████▏  | 1359/1875 [3:32:41<1:22:00,  9.54s/it]
 73%|███████▎  | 1360/1875 [3:32:51<1:23:31,  9.73s/it]
 73%|███████▎  | 1361/1875 [3:33:01<1:22:43,  9.66s/it]
 73%|███████▎  | 1362/1875 [3:33:10<1:21:55,  9.58s/it]
 73%|███████▎  | 1363/1875 [3:33:19<1:20:30,  9.43s/it]
 73%|███████▎  | 1364/1875 [3:33:29<1:20:03,  9.40s/it]
 73%|███████▎  | 1365/1875 [3:33:38<1:19:27,  9.35s/it]
 73%|███████▎  | 1366/1875 [3:33:47<1:18:59,  9.31s/it]
 73%|███████▎  | 1367/1875 [3:33:56<1:19:02,  9.33s/it]
 73%|███████▎  | 1368/1875 [3:34:06<1:19:21,  9.39s/it]
 73%|███████▎  | 1369/1875 [3:34:15<1:19:46,  9.46s/it]
 73%|███████▎  | 1370/1875 [3:34:25<1:18:57,  9.38s/it]
 73%|███████▎  | 1371/1875 [3:34:34<1:17:46,  9.26s/it]
 73%|███████▎  | 1372/1875 [3:34:42<1:16:07,  9.08s/it]
 73%|███████▎  | 1373/1875 [3:34:51<1:15:45,  9.05s/it]
 73%|███████▎  | 1374/1875 [3:35:01<1:15:58,  9.10s/it]
 73%|███████▎  | 1375/1875 [3:35:31<2:09:42, 15.57s/it]
 73%|███████▎  | 1376/1875 [3:35:40<1:53:17, 13.62s/it]Error in loading 106649 of [gpt4v-dataset/images/gpt_v7872.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v7872.jpg'], retrying...

 73%|███████▎  | 1377/1875 [3:35:50<1:43:38, 12.49s/it]
 73%|███████▎  | 1378/1875 [3:36:01<1:39:41, 12.03s/it]
 74%|███████▎  | 1379/1875 [3:36:10<1:31:46, 11.10s/it]
 74%|███████▎  | 1380/1875 [3:36:19<1:26:45, 10.52s/it]
 74%|███████▎  | 1381/1875 [3:36:28<1:23:39, 10.16s/it]Error in loading 131721 of [gpt4v-dataset/images/gpt_v11259.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v11259.jpg'], retrying...

 74%|███████▎  | 1382/1875 [3:36:38<1:21:31,  9.92s/it]
 74%|███████▍  | 1383/1875 [3:36:47<1:19:09,  9.65s/it]
 74%|███████▍  | 1384/1875 [3:36:56<1:17:40,  9.49s/it]
 74%|███████▍  | 1385/1875 [3:37:06<1:18:10,  9.57s/it]
 74%|███████▍  | 1386/1875 [3:37:15<1:18:03,  9.58s/it]
 74%|███████▍  | 1387/1875 [3:37:25<1:17:18,  9.50s/it]
 74%|███████▍  | 1388/1875 [3:37:35<1:20:02,  9.86s/it]
 74%|███████▍  | 1389/1875 [3:37:47<1:24:40, 10.45s/it]
 74%|███████▍  | 1390/1875 [3:37:58<1:24:30, 10.45s/it]
 74%|███████▍  | 1391/1875 [3:38:08<1:23:42, 10.38s/it]
 74%|███████▍  | 1392/1875 [3:38:20<1:27:40, 10.89s/it]
 74%|███████▍  | 1393/1875 [3:38:33<1:33:24, 11.63s/it]
 74%|███████▍  | 1394/1875 [3:38:43<1:29:14, 11.13s/it]
 74%|███████▍  | 1395/1875 [3:38:54<1:27:54, 10.99s/it]
 74%|███████▍  | 1396/1875 [3:39:03<1:24:09, 10.54s/it]
 75%|███████▍  | 1397/1875 [3:39:13<1:21:10, 10.19s/it]
 75%|███████▍  | 1398/1875 [3:39:22<1:18:58,  9.93s/it]
 75%|███████▍  | 1399/1875 [3:39:32<1:17:58,  9.83s/it]
 75%|███████▍  | 1400/1875 [3:39:41<1:17:31,  9.79s/it]
                                                       
{'loss': 1.2356, 'grad_norm': 2.584219455658064, 'learning_rate': 3.183808760234335e-06, 'epoch': 0.75}

 75%|███████▍  | 1400/1875 [3:39:41<1:17:31,  9.79s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 75%|███████▍  | 1401/1875 [3:41:08<4:20:06, 32.92s/it]
 75%|███████▍  | 1402/1875 [3:41:18<3:23:56, 25.87s/it]
 75%|███████▍  | 1403/1875 [3:41:27<2:44:32, 20.92s/it]
 75%|███████▍  | 1404/1875 [3:41:36<2:16:18, 17.36s/it]
 75%|███████▍  | 1405/1875 [3:41:45<1:56:29, 14.87s/it]
 75%|███████▍  | 1406/1875 [3:41:54<1:42:04, 13.06s/it]
 75%|███████▌  | 1407/1875 [3:42:03<1:32:34, 11.87s/it]
 75%|███████▌  | 1408/1875 [3:42:12<1:25:36, 11.00s/it]
 75%|███████▌  | 1409/1875 [3:42:21<1:21:13, 10.46s/it]
 75%|███████▌  | 1410/1875 [3:42:31<1:18:28, 10.13s/it]
 75%|███████▌  | 1411/1875 [3:42:40<1:15:52,  9.81s/it]
 75%|███████▌  | 1412/1875 [3:42:49<1:14:14,  9.62s/it]
 75%|███████▌  | 1413/1875 [3:43:00<1:17:03, 10.01s/it]
 75%|███████▌  | 1414/1875 [3:43:10<1:16:22,  9.94s/it]
 75%|███████▌  | 1415/1875 [3:43:20<1:16:16,  9.95s/it]
 76%|███████▌  | 1416/1875 [3:43:29<1:15:56,  9.93s/it]
 76%|███████▌  | 1417/1875 [3:43:39<1:15:10,  9.85s/it]
 76%|███████▌  | 1418/1875 [3:43:49<1:15:33,  9.92s/it]
 76%|███████▌  | 1419/1875 [3:43:59<1:14:44,  9.83s/it]
 76%|███████▌  | 1420/1875 [3:44:09<1:14:57,  9.89s/it]
 76%|███████▌  | 1421/1875 [3:44:19<1:14:41,  9.87s/it]
 76%|███████▌  | 1422/1875 [3:44:29<1:14:45,  9.90s/it]
 76%|███████▌  | 1423/1875 [3:44:38<1:12:51,  9.67s/it]
 76%|███████▌  | 1424/1875 [3:44:47<1:10:44,  9.41s/it]
 76%|███████▌  | 1425/1875 [3:44:56<1:11:01,  9.47s/it]
 76%|███████▌  | 1426/1875 [3:45:08<1:15:22, 10.07s/it]
 76%|███████▌  | 1427/1875 [3:45:17<1:14:00,  9.91s/it]
 76%|███████▌  | 1428/1875 [3:45:27<1:13:09,  9.82s/it]
 76%|███████▌  | 1429/1875 [3:45:36<1:11:00,  9.55s/it]
 76%|███████▋  | 1430/1875 [3:45:45<1:09:32,  9.38s/it]
 76%|███████▋  | 1431/1875 [3:45:54<1:09:40,  9.42s/it]
 76%|███████▋  | 1432/1875 [3:46:03<1:08:42,  9.31s/it]
 76%|███████▋  | 1433/1875 [3:46:12<1:07:40,  9.19s/it]
 76%|███████▋  | 1434/1875 [3:46:21<1:07:20,  9.16s/it]
 77%|███████▋  | 1435/1875 [3:46:38<1:23:53, 11.44s/it]
 77%|███████▋  | 1436/1875 [3:46:47<1:18:40, 10.75s/it]
 77%|███████▋  | 1437/1875 [3:46:57<1:15:25, 10.33s/it]
 77%|███████▋  | 1438/1875 [3:47:06<1:13:52, 10.14s/it]
 77%|███████▋  | 1439/1875 [3:47:15<1:11:32,  9.85s/it]
 77%|███████▋  | 1440/1875 [3:47:24<1:09:12,  9.55s/it]
 77%|███████▋  | 1441/1875 [3:47:33<1:07:47,  9.37s/it]
 77%|███████▋  | 1442/1875 [3:47:43<1:07:40,  9.38s/it]
 77%|███████▋  | 1443/1875 [3:47:52<1:07:49,  9.42s/it]
 77%|███████▋  | 1444/1875 [3:48:01<1:06:30,  9.26s/it]
 77%|███████▋  | 1445/1875 [3:48:10<1:06:11,  9.24s/it]
 77%|███████▋  | 1446/1875 [3:48:20<1:06:22,  9.28s/it]
 77%|███████▋  | 1447/1875 [3:48:30<1:07:36,  9.48s/it]
 77%|███████▋  | 1448/1875 [3:48:39<1:06:58,  9.41s/it]
 77%|███████▋  | 1449/1875 [3:48:48<1:06:34,  9.38s/it]
 77%|███████▋  | 1450/1875 [3:48:57<1:05:24,  9.23s/it]
                                                       
{'loss': 1.2245, 'grad_norm': 2.936974481257793, 'learning_rate': 2.577809166078716e-06, 'epoch': 0.77}

 77%|███████▋  | 1450/1875 [3:48:57<1:05:24,  9.23s/it]
 77%|███████▋  | 1451/1875 [3:49:06<1:04:23,  9.11s/it]
 77%|███████▋  | 1452/1875 [3:49:15<1:03:28,  9.00s/it]
 77%|███████▋  | 1453/1875 [3:49:23<1:03:00,  8.96s/it]
 78%|███████▊  | 1454/1875 [3:49:32<1:03:05,  8.99s/it]
 78%|███████▊  | 1455/1875 [3:49:41<1:02:57,  8.99s/it]
 78%|███████▊  | 1456/1875 [3:49:50<1:02:40,  8.98s/it]
 78%|███████▊  | 1457/1875 [3:49:59<1:02:22,  8.95s/it]
 78%|███████▊  | 1458/1875 [3:50:08<1:01:46,  8.89s/it]
 78%|███████▊  | 1459/1875 [3:50:17<1:02:05,  8.96s/it]
 78%|███████▊  | 1460/1875 [3:50:26<1:02:04,  8.98s/it]
 78%|███████▊  | 1461/1875 [3:50:35<1:02:27,  9.05s/it]
 78%|███████▊  | 1462/1875 [3:50:44<1:02:16,  9.05s/it]
 78%|███████▊  | 1463/1875 [3:50:54<1:02:43,  9.13s/it]
 78%|███████▊  | 1464/1875 [3:51:03<1:02:15,  9.09s/it]
 78%|███████▊  | 1465/1875 [3:51:12<1:01:35,  9.01s/it]
 78%|███████▊  | 1466/1875 [3:51:21<1:01:23,  9.01s/it]
 78%|███████▊  | 1467/1875 [3:51:30<1:01:10,  9.00s/it]
 78%|███████▊  | 1468/1875 [3:51:39<1:01:06,  9.01s/it]
 78%|███████▊  | 1469/1875 [3:51:48<1:00:50,  8.99s/it]
 78%|███████▊  | 1470/1875 [3:51:56<1:00:25,  8.95s/it]
 78%|███████▊  | 1471/1875 [3:52:05<59:57,  8.90s/it]  
 79%|███████▊  | 1472/1875 [3:52:14<1:00:03,  8.94s/it]
 79%|███████▊  | 1473/1875 [3:52:24<1:00:36,  9.05s/it]
 79%|███████▊  | 1474/1875 [3:52:33<1:00:31,  9.06s/it]
 79%|███████▊  | 1475/1875 [3:52:41<1:00:00,  9.00s/it]
 79%|███████▊  | 1476/1875 [3:52:51<1:00:00,  9.02s/it]
 79%|███████▉  | 1477/1875 [3:52:59<59:40,  9.00s/it]  
 79%|███████▉  | 1478/1875 [3:53:09<1:00:15,  9.11s/it]
 79%|███████▉  | 1479/1875 [3:53:27<1:18:00, 11.82s/it]
 79%|███████▉  | 1480/1875 [3:53:36<1:11:46, 10.90s/it]
 79%|███████▉  | 1481/1875 [3:53:45<1:08:31, 10.44s/it]
 79%|███████▉  | 1482/1875 [3:53:54<1:05:57, 10.07s/it]
 79%|███████▉  | 1483/1875 [3:54:03<1:03:57,  9.79s/it]
 79%|███████▉  | 1484/1875 [3:54:12<1:02:16,  9.56s/it]
 79%|███████▉  | 1485/1875 [3:54:21<1:00:56,  9.38s/it]
 79%|███████▉  | 1486/1875 [3:54:30<59:48,  9.23s/it]  
 79%|███████▉  | 1487/1875 [3:54:39<58:38,  9.07s/it]
 79%|███████▉  | 1488/1875 [3:54:48<58:35,  9.08s/it]
 79%|███████▉  | 1489/1875 [3:54:58<59:38,  9.27s/it]
 79%|███████▉  | 1490/1875 [3:55:07<59:11,  9.23s/it]
 80%|███████▉  | 1491/1875 [3:55:17<59:55,  9.36s/it]
 80%|███████▉  | 1492/1875 [3:55:26<59:42,  9.35s/it]
 80%|███████▉  | 1493/1875 [3:55:35<58:27,  9.18s/it]
 80%|███████▉  | 1494/1875 [3:55:44<57:55,  9.12s/it]
 80%|███████▉  | 1495/1875 [3:55:53<57:24,  9.06s/it]
 80%|███████▉  | 1496/1875 [3:56:02<57:21,  9.08s/it]
 80%|███████▉  | 1497/1875 [3:56:11<57:19,  9.10s/it]
 80%|███████▉  | 1498/1875 [3:56:20<57:14,  9.11s/it]
 80%|███████▉  | 1499/1875 [3:56:29<57:23,  9.16s/it]
 80%|████████  | 1500/1875 [3:56:39<57:49,  9.25s/it]
                                                     
{'loss': 1.2333, 'grad_norm': 3.0738854187411664, 'learning_rate': 2.0271845943008984e-06, 'epoch': 0.8}

 80%|████████  | 1500/1875 [3:56:39<57:49,  9.25s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 80%|████████  | 1501/1875 [3:57:33<2:21:01, 22.62s/it]
 80%|████████  | 1502/1875 [3:57:42<1:55:49, 18.63s/it]
 80%|████████  | 1503/1875 [3:57:51<1:37:05, 15.66s/it]
 80%|████████  | 1504/1875 [3:58:00<1:24:38, 13.69s/it]
 80%|████████  | 1505/1875 [3:58:08<1:14:54, 12.15s/it]
 80%|████████  | 1506/1875 [3:58:17<1:09:01, 11.22s/it]
 80%|████████  | 1507/1875 [3:58:26<1:04:37, 10.54s/it]
 80%|████████  | 1508/1875 [3:58:35<1:01:15, 10.02s/it]
 80%|████████  | 1509/1875 [3:58:46<1:02:25, 10.23s/it]
 81%|████████  | 1510/1875 [3:58:58<1:06:15, 10.89s/it]
 81%|████████  | 1511/1875 [3:59:10<1:07:13, 11.08s/it]
 81%|████████  | 1512/1875 [3:59:21<1:06:55, 11.06s/it]
 81%|████████  | 1513/1875 [3:59:30<1:04:09, 10.63s/it]
 81%|████████  | 1514/1875 [3:59:40<1:01:36, 10.24s/it]
 81%|████████  | 1515/1875 [3:59:49<59:47,  9.96s/it]  
 81%|████████  | 1516/1875 [3:59:58<58:34,  9.79s/it]
 81%|████████  | 1517/1875 [4:00:08<57:52,  9.70s/it]
 81%|████████  | 1518/1875 [4:00:17<56:12,  9.45s/it]
 81%|████████  | 1519/1875 [4:00:26<55:47,  9.40s/it]
 81%|████████  | 1520/1875 [4:00:36<56:23,  9.53s/it]
 81%|████████  | 1521/1875 [4:00:45<56:01,  9.50s/it]
 81%|████████  | 1522/1875 [4:00:55<55:17,  9.40s/it]
 81%|████████  | 1523/1875 [4:01:04<54:48,  9.34s/it]
 81%|████████▏ | 1524/1875 [4:01:13<54:19,  9.29s/it]
 81%|████████▏ | 1525/1875 [4:01:22<54:08,  9.28s/it]
 81%|████████▏ | 1526/1875 [4:01:31<53:14,  9.15s/it]
 81%|████████▏ | 1527/1875 [4:02:13<1:50:20, 19.02s/it]
 81%|████████▏ | 1528/1875 [4:02:22<1:32:43, 16.03s/it]
 82%|████████▏ | 1529/1875 [4:02:31<1:20:13, 13.91s/it]
 82%|████████▏ | 1530/1875 [4:02:40<1:11:13, 12.39s/it]
 82%|████████▏ | 1531/1875 [4:02:49<1:04:58, 11.33s/it]
 82%|████████▏ | 1532/1875 [4:02:58<1:00:38, 10.61s/it]
 82%|████████▏ | 1533/1875 [4:03:07<58:09, 10.20s/it]  
 82%|████████▏ | 1534/1875 [4:03:16<55:57,  9.85s/it]
 82%|████████▏ | 1535/1875 [4:03:25<54:22,  9.59s/it]
 82%|████████▏ | 1536/1875 [4:03:34<53:20,  9.44s/it]
 82%|████████▏ | 1537/1875 [4:03:43<52:40,  9.35s/it]
 82%|████████▏ | 1538/1875 [4:03:52<52:12,  9.29s/it]
 82%|████████▏ | 1539/1875 [4:04:02<52:03,  9.30s/it]
 82%|████████▏ | 1540/1875 [4:04:16<1:00:02, 10.75s/it]
 82%|████████▏ | 1541/1875 [4:04:27<1:00:09, 10.81s/it]
 82%|████████▏ | 1542/1875 [4:04:36<57:50, 10.42s/it]  
 82%|████████▏ | 1543/1875 [4:04:46<56:37, 10.23s/it]
 82%|████████▏ | 1544/1875 [4:04:56<56:11, 10.19s/it]
 82%|████████▏ | 1545/1875 [4:05:06<54:55,  9.99s/it]
 82%|████████▏ | 1546/1875 [4:05:15<53:22,  9.73s/it]
 83%|████████▎ | 1547/1875 [4:05:25<53:32,  9.80s/it]
 83%|████████▎ | 1548/1875 [4:05:35<54:08,  9.93s/it]
 83%|████████▎ | 1549/1875 [4:05:48<58:58, 10.85s/it]
 83%|████████▎ | 1550/1875 [4:05:59<58:49, 10.86s/it]
                                                     
{'loss': 1.2251, 'grad_norm': 2.8572819454534426, 'learning_rate': 1.536043110654809e-06, 'epoch': 0.83}

 83%|████████▎ | 1550/1875 [4:05:59<58:49, 10.86s/it]
 83%|████████▎ | 1551/1875 [4:06:08<56:25, 10.45s/it]
 83%|████████▎ | 1552/1875 [4:06:17<53:36,  9.96s/it]
 83%|████████▎ | 1553/1875 [4:06:26<51:58,  9.68s/it]
 83%|████████▎ | 1554/1875 [4:06:36<51:39,  9.66s/it]
 83%|████████▎ | 1555/1875 [4:06:46<52:17,  9.80s/it]
 83%|████████▎ | 1556/1875 [4:06:56<52:48,  9.93s/it]
 83%|████████▎ | 1557/1875 [4:07:06<52:13,  9.85s/it]
 83%|████████▎ | 1558/1875 [4:07:16<52:30,  9.94s/it]
 83%|████████▎ | 1559/1875 [4:07:26<51:55,  9.86s/it]
 83%|████████▎ | 1560/1875 [4:07:36<52:36, 10.02s/it]
 83%|████████▎ | 1561/1875 [4:07:46<52:22, 10.01s/it]
 83%|████████▎ | 1562/1875 [4:07:56<51:45,  9.92s/it]
 83%|████████▎ | 1563/1875 [4:08:06<52:20, 10.06s/it]
 83%|████████▎ | 1564/1875 [4:08:16<51:23,  9.92s/it]
 83%|████████▎ | 1565/1875 [4:08:25<49:44,  9.63s/it]
 84%|████████▎ | 1566/1875 [4:08:34<48:27,  9.41s/it]
 84%|████████▎ | 1567/1875 [4:08:42<47:15,  9.21s/it]
 84%|████████▎ | 1568/1875 [4:08:52<47:51,  9.35s/it]
 84%|████████▎ | 1569/1875 [4:09:01<47:51,  9.38s/it]
 84%|████████▎ | 1570/1875 [4:09:12<49:35,  9.76s/it]
 84%|████████▍ | 1571/1875 [4:09:21<48:42,  9.61s/it]
 84%|████████▍ | 1572/1875 [4:09:31<48:20,  9.57s/it]
 84%|████████▍ | 1573/1875 [4:09:40<47:58,  9.53s/it]
 84%|████████▍ | 1574/1875 [4:09:57<59:10, 11.80s/it]
 84%|████████▍ | 1575/1875 [4:10:07<55:23, 11.08s/it]
 84%|████████▍ | 1576/1875 [4:10:16<52:01, 10.44s/it]
 84%|████████▍ | 1577/1875 [4:10:25<49:27,  9.96s/it]
 84%|████████▍ | 1578/1875 [4:10:34<48:16,  9.75s/it]
 84%|████████▍ | 1579/1875 [4:10:43<47:47,  9.69s/it]
 84%|████████▍ | 1580/1875 [4:10:53<47:06,  9.58s/it]
 84%|████████▍ | 1581/1875 [4:11:02<47:12,  9.63s/it]
 84%|████████▍ | 1582/1875 [4:11:14<49:39, 10.17s/it]
 84%|████████▍ | 1583/1875 [4:11:23<47:56,  9.85s/it]
 84%|████████▍ | 1584/1875 [4:11:32<46:34,  9.60s/it]
 85%|████████▍ | 1585/1875 [4:11:41<45:51,  9.49s/it]
 85%|████████▍ | 1586/1875 [4:11:50<44:57,  9.33s/it]
 85%|████████▍ | 1587/1875 [4:11:59<44:24,  9.25s/it]
 85%|████████▍ | 1588/1875 [4:12:08<43:43,  9.14s/it]
 85%|████████▍ | 1589/1875 [4:12:17<43:07,  9.05s/it]
 85%|████████▍ | 1590/1875 [4:12:26<42:23,  8.92s/it]
 85%|████████▍ | 1591/1875 [4:12:34<42:07,  8.90s/it]
 85%|████████▍ | 1592/1875 [4:12:43<42:08,  8.93s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/PIL/TiffImagePlugin.py:900: UserWarning: Corrupt EXIF data.  Expecting to read 12 bytes but only got 8. 
  warnings.warn(str(msg))

 85%|████████▍ | 1593/1875 [4:12:53<42:20,  9.01s/it]
 85%|████████▌ | 1594/1875 [4:13:01<41:53,  8.95s/it]
 85%|████████▌ | 1595/1875 [4:13:10<41:52,  8.97s/it]
 85%|████████▌ | 1596/1875 [4:13:20<42:09,  9.07s/it]
 85%|████████▌ | 1597/1875 [4:13:29<41:32,  8.97s/it]
 85%|████████▌ | 1598/1875 [4:13:38<41:31,  9.00s/it]
 85%|████████▌ | 1599/1875 [4:13:47<41:29,  9.02s/it]
 85%|████████▌ | 1600/1875 [4:13:55<41:04,  8.96s/it]
                                                     
{'loss': 1.2197, 'grad_norm': 3.1691250405165845, 'learning_rate': 1.108048993148939e-06, 'epoch': 0.85}

 85%|████████▌ | 1600/1875 [4:13:55<41:04,  8.96s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 85%|████████▌ | 1601/1875 [4:14:36<1:24:10, 18.43s/it]
 85%|████████▌ | 1602/1875 [4:14:45<1:10:56, 15.59s/it]
 85%|████████▌ | 1603/1875 [4:14:54<1:01:42, 13.61s/it]
 86%|████████▌ | 1604/1875 [4:15:03<55:09, 12.21s/it]  
 86%|████████▌ | 1605/1875 [4:15:12<51:15, 11.39s/it]
 86%|████████▌ | 1606/1875 [4:15:29<58:32, 13.06s/it]
 86%|████████▌ | 1607/1875 [4:15:38<52:26, 11.74s/it]
 86%|████████▌ | 1608/1875 [4:15:47<48:43, 10.95s/it]
 86%|████████▌ | 1609/1875 [4:15:56<46:00, 10.38s/it]
 86%|████████▌ | 1610/1875 [4:16:05<44:08,  9.99s/it]
 86%|████████▌ | 1611/1875 [4:16:14<42:59,  9.77s/it]
 86%|████████▌ | 1612/1875 [4:16:24<41:50,  9.55s/it]
 86%|████████▌ | 1613/1875 [4:16:33<41:36,  9.53s/it]
 86%|████████▌ | 1614/1875 [4:16:42<40:30,  9.31s/it]
 86%|████████▌ | 1615/1875 [4:16:51<39:44,  9.17s/it]
 86%|████████▌ | 1616/1875 [4:17:00<39:47,  9.22s/it]
 86%|████████▌ | 1617/1875 [4:17:10<40:07,  9.33s/it]
 86%|████████▋ | 1618/1875 [4:17:19<40:16,  9.40s/it]
 86%|████████▋ | 1619/1875 [4:17:29<40:09,  9.41s/it]
 86%|████████▋ | 1620/1875 [4:17:38<40:16,  9.48s/it]
 86%|████████▋ | 1621/1875 [4:17:48<39:55,  9.43s/it]
 87%|████████▋ | 1622/1875 [4:17:57<39:49,  9.44s/it]
 87%|████████▋ | 1623/1875 [4:18:06<38:50,  9.25s/it]
 87%|████████▋ | 1624/1875 [4:18:15<38:20,  9.17s/it]
 87%|████████▋ | 1625/1875 [4:18:24<38:45,  9.30s/it]
 87%|████████▋ | 1626/1875 [4:18:33<37:51,  9.12s/it]
 87%|████████▋ | 1627/1875 [4:18:42<37:33,  9.09s/it]
 87%|████████▋ | 1628/1875 [4:18:51<37:30,  9.11s/it]
 87%|████████▋ | 1629/1875 [4:19:00<37:18,  9.10s/it]
 87%|████████▋ | 1630/1875 [4:19:10<37:16,  9.13s/it]
 87%|████████▋ | 1631/1875 [4:19:19<38:01,  9.35s/it]
 87%|████████▋ | 1632/1875 [4:19:28<37:27,  9.25s/it]
 87%|████████▋ | 1633/1875 [4:19:37<36:44,  9.11s/it]
 87%|████████▋ | 1634/1875 [4:19:46<36:42,  9.14s/it]
 87%|████████▋ | 1635/1875 [4:19:55<36:13,  9.06s/it]
 87%|████████▋ | 1636/1875 [4:20:04<35:48,  8.99s/it]
 87%|████████▋ | 1637/1875 [4:20:13<35:30,  8.95s/it]
 87%|████████▋ | 1638/1875 [4:20:22<35:24,  8.96s/it]
 87%|████████▋ | 1639/1875 [4:20:31<35:14,  8.96s/it]
 87%|████████▋ | 1640/1875 [4:20:40<35:00,  8.94s/it]
 88%|████████▊ | 1641/1875 [4:20:49<34:44,  8.91s/it]
 88%|████████▊ | 1642/1875 [4:20:57<34:27,  8.87s/it]
 88%|████████▊ | 1643/1875 [4:21:06<34:18,  8.87s/it]
 88%|████████▊ | 1644/1875 [4:21:15<34:22,  8.93s/it]
 88%|████████▊ | 1645/1875 [4:21:24<34:07,  8.90s/it]
 88%|████████▊ | 1646/1875 [4:21:33<33:59,  8.90s/it]
 88%|████████▊ | 1647/1875 [4:21:42<33:33,  8.83s/it]
 88%|████████▊ | 1648/1875 [4:21:51<33:49,  8.94s/it]
 88%|████████▊ | 1649/1875 [4:22:00<33:52,  8.99s/it]
 88%|████████▊ | 1650/1875 [4:22:09<34:05,  9.09s/it]
                                                     
{'loss': 1.2242, 'grad_norm': 2.724010955601499, 'learning_rate': 7.463953938275859e-07, 'epoch': 0.88}

 88%|████████▊ | 1650/1875 [4:22:09<34:05,  9.09s/it]
 88%|████████▊ | 1651/1875 [4:22:18<33:43,  9.03s/it]
 88%|████████▊ | 1652/1875 [4:22:27<33:25,  8.99s/it]
 88%|████████▊ | 1653/1875 [4:22:36<32:55,  8.90s/it]
 88%|████████▊ | 1654/1875 [4:22:45<33:10,  9.01s/it]
 88%|████████▊ | 1655/1875 [4:22:54<32:56,  8.99s/it]
 88%|████████▊ | 1656/1875 [4:23:04<33:18,  9.12s/it]
 88%|████████▊ | 1657/1875 [4:23:12<32:55,  9.06s/it]
 88%|████████▊ | 1658/1875 [4:23:21<32:34,  9.01s/it]
 88%|████████▊ | 1659/1875 [4:23:30<32:22,  8.99s/it]
 89%|████████▊ | 1660/1875 [4:23:39<32:17,  9.01s/it]
 89%|████████▊ | 1661/1875 [4:23:48<32:17,  9.05s/it]
 89%|████████▊ | 1662/1875 [4:23:58<32:44,  9.22s/it]
 89%|████████▊ | 1663/1875 [4:24:07<32:27,  9.19s/it]
 89%|████████▊ | 1664/1875 [4:24:16<32:05,  9.13s/it]
 89%|████████▉ | 1665/1875 [4:24:25<31:31,  9.01s/it]
 89%|████████▉ | 1666/1875 [4:24:34<31:11,  8.95s/it]
 89%|████████▉ | 1667/1875 [4:24:43<31:02,  8.95s/it]
 89%|████████▉ | 1668/1875 [4:24:51<30:42,  8.90s/it]
 89%|████████▉ | 1669/1875 [4:25:01<30:51,  8.99s/it]
 89%|████████▉ | 1670/1875 [4:25:09<30:32,  8.94s/it]
 89%|████████▉ | 1671/1875 [4:25:18<30:13,  8.89s/it]
 89%|████████▉ | 1672/1875 [4:25:28<30:52,  9.13s/it]
 89%|████████▉ | 1673/1875 [4:25:37<31:01,  9.21s/it]
 89%|████████▉ | 1674/1875 [4:25:47<30:57,  9.24s/it]
 89%|████████▉ | 1675/1875 [4:25:56<30:27,  9.14s/it]
 89%|████████▉ | 1676/1875 [4:26:05<30:10,  9.10s/it]
 89%|████████▉ | 1677/1875 [4:26:14<30:25,  9.22s/it]
 89%|████████▉ | 1678/1875 [4:26:24<30:40,  9.34s/it]
 90%|████████▉ | 1679/1875 [4:26:33<30:18,  9.28s/it]
 90%|████████▉ | 1680/1875 [4:26:42<30:05,  9.26s/it]
 90%|████████▉ | 1681/1875 [4:26:52<30:08,  9.32s/it]
 90%|████████▉ | 1682/1875 [4:27:01<29:44,  9.25s/it]
 90%|████████▉ | 1683/1875 [4:27:10<29:28,  9.21s/it]
 90%|████████▉ | 1684/1875 [4:27:19<29:19,  9.21s/it]
 90%|████████▉ | 1685/1875 [4:27:28<29:15,  9.24s/it]
 90%|████████▉ | 1686/1875 [4:27:37<29:01,  9.21s/it]Error in loading 223436 of [gpt4v-dataset/images/gpt_v2516.png] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v2516.png'], retrying...

 90%|████████▉ | 1687/1875 [4:27:47<28:58,  9.25s/it]
 90%|█████████ | 1688/1875 [4:27:56<28:59,  9.30s/it]
 90%|█████████ | 1689/1875 [4:28:05<28:28,  9.18s/it]
 90%|█████████ | 1690/1875 [4:28:14<28:19,  9.19s/it]
 90%|█████████ | 1691/1875 [4:28:23<27:54,  9.10s/it]
 90%|█████████ | 1692/1875 [4:28:32<27:50,  9.13s/it]
 90%|█████████ | 1693/1875 [4:28:43<28:40,  9.45s/it]
 90%|█████████ | 1694/1875 [4:29:04<39:05, 12.96s/it]
 90%|█████████ | 1695/1875 [4:29:13<35:26, 11.81s/it]
 90%|█████████ | 1696/1875 [4:29:22<33:04, 11.09s/it]
 91%|█████████ | 1697/1875 [4:29:31<31:06, 10.49s/it]
 91%|█████████ | 1698/1875 [4:29:40<29:40, 10.06s/it]
 91%|█████████ | 1699/1875 [4:29:50<28:47,  9.81s/it]
 91%|█████████ | 1700/1875 [4:29:59<27:59,  9.60s/it]
                                                     
{'loss': 1.2174, 'grad_norm': 3.0040677640139726, 'learning_rate': 4.5378051549952783e-07, 'epoch': 0.91}

 91%|█████████ | 1700/1875 [4:29:59<27:59,  9.60s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 91%|█████████ | 1701/1875 [4:30:31<47:34, 16.41s/it]Error in loading 76136 of [gpt4v-dataset/images/gpt_v11518.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v11518.jpg'], retrying...

 91%|█████████ | 1702/1875 [4:30:40<41:11, 14.29s/it]
 91%|█████████ | 1703/1875 [4:30:50<36:53, 12.87s/it]
 91%|█████████ | 1704/1875 [4:30:59<33:04, 11.61s/it]
 91%|█████████ | 1705/1875 [4:31:07<30:34, 10.79s/it]
 91%|█████████ | 1706/1875 [4:31:17<29:03, 10.32s/it]
 91%|█████████ | 1707/1875 [4:31:26<27:45,  9.91s/it]
 91%|█████████ | 1708/1875 [4:31:35<27:21,  9.83s/it]
 91%|█████████ | 1709/1875 [4:31:45<26:58,  9.75s/it]
 91%|█████████ | 1710/1875 [4:31:54<26:22,  9.59s/it]
 91%|█████████▏| 1711/1875 [4:32:03<26:01,  9.52s/it]
 91%|█████████▏| 1712/1875 [4:32:13<25:35,  9.42s/it]
 91%|█████████▏| 1713/1875 [4:32:22<25:25,  9.42s/it]
 91%|█████████▏| 1714/1875 [4:32:32<26:03,  9.71s/it]
 91%|█████████▏| 1715/1875 [4:32:42<25:38,  9.62s/it]
 92%|█████████▏| 1716/1875 [4:32:51<24:52,  9.39s/it]
 92%|█████████▏| 1717/1875 [4:33:00<24:18,  9.23s/it]
 92%|█████████▏| 1718/1875 [4:33:08<23:56,  9.15s/it]
 92%|█████████▏| 1719/1875 [4:33:18<23:54,  9.20s/it]
 92%|█████████▏| 1720/1875 [4:33:27<23:38,  9.15s/it]
 92%|█████████▏| 1721/1875 [4:33:36<23:25,  9.13s/it]
 92%|█████████▏| 1722/1875 [4:33:45<23:14,  9.11s/it]
 92%|█████████▏| 1723/1875 [4:33:54<23:05,  9.11s/it]
 92%|█████████▏| 1724/1875 [4:34:03<22:54,  9.10s/it]
 92%|█████████▏| 1725/1875 [4:34:12<22:37,  9.05s/it]
 92%|█████████▏| 1726/1875 [4:34:21<22:40,  9.13s/it]
 92%|█████████▏| 1727/1875 [4:34:30<22:15,  9.02s/it]
 92%|█████████▏| 1728/1875 [4:34:39<22:02,  9.00s/it]
 92%|█████████▏| 1729/1875 [4:34:48<21:47,  8.95s/it]
 92%|█████████▏| 1730/1875 [4:34:57<21:39,  8.96s/it]
 92%|█████████▏| 1731/1875 [4:35:06<21:26,  8.94s/it]
 92%|█████████▏| 1732/1875 [4:35:15<21:07,  8.86s/it]
 92%|█████████▏| 1733/1875 [4:35:24<21:30,  9.09s/it]
 92%|█████████▏| 1734/1875 [4:35:33<21:10,  9.01s/it]
 93%|█████████▎| 1735/1875 [4:35:42<21:12,  9.09s/it]
 93%|█████████▎| 1736/1875 [4:35:51<20:53,  9.02s/it]
 93%|█████████▎| 1737/1875 [4:36:00<20:51,  9.07s/it]
 93%|█████████▎| 1738/1875 [4:36:09<20:45,  9.09s/it]
 93%|█████████▎| 1739/1875 [4:36:19<20:46,  9.16s/it]
 93%|█████████▎| 1740/1875 [4:36:28<20:52,  9.28s/it]
 93%|█████████▎| 1741/1875 [4:36:38<20:47,  9.31s/it]
 93%|█████████▎| 1742/1875 [4:36:47<20:23,  9.20s/it]
 93%|█████████▎| 1743/1875 [4:36:55<20:00,  9.09s/it]
 93%|█████████▎| 1744/1875 [4:37:05<19:51,  9.10s/it]
 93%|█████████▎| 1745/1875 [4:37:13<19:26,  8.97s/it]
 93%|█████████▎| 1746/1875 [4:37:23<19:32,  9.09s/it]
 93%|█████████▎| 1747/1875 [4:37:31<19:13,  9.01s/it]
 93%|█████████▎| 1748/1875 [4:37:41<19:18,  9.12s/it]
 93%|█████████▎| 1749/1875 [4:37:50<19:05,  9.09s/it]
 93%|█████████▎| 1750/1875 [4:37:59<18:55,  9.08s/it]
                                                     
{'loss': 1.2105, 'grad_norm': 2.6322978751120885, 'learning_rate': 2.3238748115339327e-07, 'epoch': 0.93}

 93%|█████████▎| 1750/1875 [4:37:59<18:55,  9.08s/it]
 93%|█████████▎| 1751/1875 [4:38:08<18:46,  9.09s/it]
 93%|█████████▎| 1752/1875 [4:38:17<18:27,  9.00s/it]
 93%|█████████▎| 1753/1875 [4:38:26<18:26,  9.07s/it]
 94%|█████████▎| 1754/1875 [4:38:35<18:22,  9.11s/it]
 94%|█████████▎| 1755/1875 [4:38:44<18:17,  9.14s/it]
 94%|█████████▎| 1756/1875 [4:38:54<18:16,  9.22s/it]
 94%|█████████▎| 1757/1875 [4:39:03<18:04,  9.19s/it]
 94%|█████████▍| 1758/1875 [4:39:12<17:49,  9.14s/it]
 94%|█████████▍| 1759/1875 [4:39:21<17:32,  9.07s/it]
 94%|█████████▍| 1760/1875 [4:39:30<17:26,  9.10s/it]
 94%|█████████▍| 1761/1875 [4:39:39<17:10,  9.04s/it]
 94%|█████████▍| 1762/1875 [4:39:48<16:49,  8.93s/it]
 94%|█████████▍| 1763/1875 [4:39:57<16:49,  9.01s/it]
 94%|█████████▍| 1764/1875 [4:40:06<16:49,  9.09s/it]
 94%|█████████▍| 1765/1875 [4:40:15<16:36,  9.06s/it]
 94%|█████████▍| 1766/1875 [4:40:24<16:24,  9.03s/it]
 94%|█████████▍| 1767/1875 [4:40:33<16:16,  9.04s/it]
 94%|█████████▍| 1768/1875 [4:40:42<16:03,  9.00s/it]
 94%|█████████▍| 1769/1875 [4:40:51<15:50,  8.97s/it]
 94%|█████████▍| 1770/1875 [4:41:00<15:40,  8.96s/it]
 94%|█████████▍| 1771/1875 [4:41:09<15:38,  9.03s/it]
 95%|█████████▍| 1772/1875 [4:41:18<15:27,  9.00s/it]
 95%|█████████▍| 1773/1875 [4:41:27<15:10,  8.93s/it]
 95%|█████████▍| 1774/1875 [4:41:36<15:03,  8.94s/it]
 95%|█████████▍| 1775/1875 [4:41:45<14:51,  8.91s/it]
 95%|█████████▍| 1776/1875 [4:41:54<14:53,  9.02s/it]
 95%|█████████▍| 1777/1875 [4:42:03<14:44,  9.02s/it]
 95%|█████████▍| 1778/1875 [4:42:12<14:38,  9.05s/it]
 95%|█████████▍| 1779/1875 [4:42:21<14:26,  9.03s/it]
 95%|█████████▍| 1780/1875 [4:42:30<14:15,  9.01s/it]
 95%|█████████▍| 1781/1875 [4:42:39<14:04,  8.99s/it]
 95%|█████████▌| 1782/1875 [4:42:48<13:57,  9.01s/it]
 95%|█████████▌| 1783/1875 [4:42:57<13:40,  8.91s/it]
 95%|█████████▌| 1784/1875 [4:43:06<13:35,  8.97s/it]
 95%|█████████▌| 1785/1875 [4:43:15<13:34,  9.05s/it]
 95%|█████████▌| 1786/1875 [4:43:24<13:22,  9.02s/it]
 95%|█████████▌| 1787/1875 [4:43:33<13:08,  8.96s/it]
 95%|█████████▌| 1788/1875 [4:43:41<12:52,  8.88s/it]
 95%|█████████▌| 1789/1875 [4:43:51<12:49,  8.94s/it]
 95%|█████████▌| 1790/1875 [4:43:59<12:40,  8.94s/it]
 96%|█████████▌| 1791/1875 [4:44:09<12:36,  9.01s/it]
 96%|█████████▌| 1792/1875 [4:44:17<12:23,  8.96s/it]
 96%|█████████▌| 1793/1875 [4:44:26<12:13,  8.94s/it]
 96%|█████████▌| 1794/1875 [4:44:36<12:09,  9.00s/it]Error in loading 219952 of [gpt4v-dataset/images/gpt_v4286.jpg] with exception info [cannot identify image file '/data/cjk/project/wjc/dj_synth_challenge/toolkit/training/data/finetuning_stage_1/gpt4v-dataset/images/gpt_v4286.jpg'], retrying...

 96%|█████████▌| 1795/1875 [4:44:45<12:00,  9.01s/it]
 96%|█████████▌| 1796/1875 [4:44:54<11:50,  9.00s/it]
 96%|█████████▌| 1797/1875 [4:45:02<11:38,  8.95s/it]
 96%|█████████▌| 1798/1875 [4:45:11<11:27,  8.93s/it]
 96%|█████████▌| 1799/1875 [4:45:20<11:19,  8.95s/it]
 96%|█████████▌| 1800/1875 [4:45:29<11:09,  8.92s/it]
                                                     
{'loss': 1.2074, 'grad_norm': 2.8068553856331255, 'learning_rate': 8.386804624865851e-08, 'epoch': 0.96}

 96%|█████████▌| 1800/1875 [4:45:29<11:09,  8.92s/it]/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/data/cjk/miniconda3/envs/dj2/lib/python3.10/site-packages/torch/utils/checkpoint.py:31: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")

 96%|█████████▌| 1801/1875 [4:46:02<20:02, 16.25s/it]
 96%|█████████▌| 1802/1875 [4:46:11<17:01, 13.99s/it]
 96%|█████████▌| 1803/1875 [4:46:20<14:53, 12.41s/it]
 96%|█████████▌| 1804/1875 [4:46:29<13:23, 11.32s/it]
 96%|█████████▋| 1805/1875 [4:46:37<12:18, 10.54s/it]
 96%|█████████▋| 1806/1875 [4:46:47<11:38, 10.12s/it]
 96%|█████████▋| 1807/1875 [4:46:55<10:59,  9.70s/it]
 96%|█████████▋| 1808/1875 [4:47:04<10:32,  9.44s/it]
 96%|█████████▋| 1809/1875 [4:47:13<10:21,  9.41s/it]
 97%|█████████▋| 1810/1875 [4:47:22<10:05,  9.31s/it]
 97%|█████████▋| 1811/1875 [4:47:34<10:36,  9.95s/it]
 97%|█████████▋| 1812/1875 [4:47:44<10:22,  9.88s/it]
 97%|█████████▋| 1813/1875 [4:47:53<09:53,  9.57s/it]
 97%|█████████▋| 1814/1875 [4:48:01<09:30,  9.35s/it]
 97%|█████████▋| 1815/1875 [4:48:10<09:11,  9.20s/it]
 97%|█████████▋| 1816/1875 [4:48:20<09:14,  9.40s/it]
 97%|█████████▋| 1817/1875 [4:48:31<09:25,  9.74s/it]
 97%|█████████▋| 1818/1875 [4:48:48<11:31, 12.14s/it]
 97%|█████████▋| 1819/1875 [4:48:59<10:56, 11.72s/it]
 97%|█████████▋| 1820/1875 [4:49:09<10:12, 11.14s/it]
 97%|█████████▋| 1821/1875 [4:49:18<09:29, 10.55s/it]
 97%|█████████▋| 1822/1875 [4:49:28<09:08, 10.35s/it]
 97%|█████████▋| 1823/1875 [4:49:38<08:52, 10.25s/it]
 97%|█████████▋| 1824/1875 [4:49:47<08:28,  9.97s/it]
 97%|█████████▋| 1825/1875 [4:49:56<08:05,  9.70s/it]
 97%|█████████▋| 1826/1875 [4:50:06<07:55,  9.71s/it]
 97%|█████████▋| 1827/1875 [4:50:15<07:37,  9.54s/it]
 97%|█████████▋| 1828/1875 [4:50:24<07:17,  9.31s/it]
 98%|█████████▊| 1829/1875 [4:50:33<07:06,  9.26s/it]
 98%|█████████▊| 1830/1875 [4:50:42<06:55,  9.24s/it]
 98%|█████████▊| 1831/1875 [4:50:52<06:48,  9.28s/it]
 98%|█████████▊| 1832/1875 [4:51:01<06:34,  9.17s/it]
 98%|█████████▊| 1833/1875 [4:51:09<06:20,  9.06s/it]
 98%|█████████▊| 1834/1875 [4:51:18<06:08,  8.98s/it]
 98%|█████████▊| 1835/1875 [4:51:27<05:57,  8.94s/it]
 98%|█████████▊| 1836/1875 [4:51:36<05:48,  8.92s/it]
 98%|█████████▊| 1837/1875 [4:51:45<05:37,  8.87s/it]
 98%|█████████▊| 1838/1875 [4:51:54<05:28,  8.87s/it]
 98%|█████████▊| 1839/1875 [4:52:02<05:19,  8.87s/it]
 98%|█████████▊| 1840/1875 [4:52:11<05:09,  8.85s/it]
 98%|█████████▊| 1841/1875 [4:52:20<05:04,  8.95s/it]
 98%|█████████▊| 1842/1875 [4:52:29<04:55,  8.94s/it]
 98%|█████████▊| 1843/1875 [4:52:38<04:44,  8.89s/it]
 98%|█████████▊| 1844/1875 [4:52:47<04:33,  8.83s/it]
 98%|█████████▊| 1845/1875 [4:52:56<04:25,  8.84s/it]
 98%|█████████▊| 1846/1875 [4:53:05<04:17,  8.88s/it]
 99%|█████████▊| 1847/1875 [4:53:14<04:10,  8.94s/it]
 99%|█████████▊| 1848/1875 [4:53:23<04:00,  8.90s/it]
 99%|█████████▊| 1849/1875 [4:53:31<03:50,  8.88s/it]
 99%|█████████▊| 1850/1875 [4:53:40<03:41,  8.85s/it]
                                                     
{'loss': 1.2054, 'grad_norm': 2.8947283923254195, 'learning_rate': 9.330275400666334e-09, 'epoch': 0.99}

 99%|█████████▊| 1850/1875 [4:53:40<03:41,  8.85s/it]
 99%|█████████▊| 1851/1875 [4:53:49<03:31,  8.83s/it]
 99%|█████████▉| 1852/1875 [4:53:58<03:22,  8.81s/it]
 99%|█████████▉| 1853/1875 [4:54:06<03:12,  8.75s/it]
 99%|█████████▉| 1854/1875 [4:54:15<03:04,  8.76s/it]
 99%|█████████▉| 1855/1875 [4:54:24<02:55,  8.76s/it]
 99%|█████████▉| 1856/1875 [4:54:33<02:47,  8.81s/it]
 99%|█████████▉| 1857/1875 [4:54:42<02:39,  8.87s/it]
 99%|█████████▉| 1858/1875 [4:54:51<02:31,  8.90s/it]
 99%|█████████▉| 1859/1875 [4:55:00<02:22,  8.93s/it]
 99%|█████████▉| 1860/1875 [4:55:09<02:15,  9.00s/it]
 99%|█████████▉| 1861/1875 [4:55:18<02:04,  8.88s/it]
 99%|█████████▉| 1862/1875 [4:55:26<01:55,  8.89s/it]
 99%|█████████▉| 1863/1875 [4:55:35<01:46,  8.91s/it]
 99%|█████████▉| 1864/1875 [4:55:44<01:37,  8.90s/it]
 99%|█████████▉| 1865/1875 [4:55:53<01:29,  8.93s/it]
100%|█████████▉| 1866/1875 [4:56:02<01:20,  8.89s/it]
100%|█████████▉| 1867/1875 [4:56:11<01:10,  8.86s/it]
100%|█████████▉| 1868/1875 [4:56:20<01:02,  8.87s/it]
100%|█████████▉| 1869/1875 [4:56:29<00:53,  8.86s/it]
100%|█████████▉| 1870/1875 [4:56:38<00:44,  8.90s/it]
100%|█████████▉| 1871/1875 [4:56:46<00:35,  8.92s/it]
100%|█████████▉| 1872/1875 [4:56:55<00:26,  8.89s/it]
100%|█████████▉| 1873/1875 [4:57:11<00:22, 11.02s/it]
100%|█████████▉| 1874/1875 [4:57:20<00:10, 10.32s/it]
100%|██████████| 1875/1875 [4:57:30<00:00, 10.17s/it]
                                                     
{'train_runtime': 17850.335, 'train_samples_per_second': 13.445, 'train_steps_per_second': 0.105, 'train_loss': 1.3123791015625, 'epoch': 1.0}

100%|██████████| 1875/1875 [4:57:30<00:00, 10.17s/it]
100%|██████████| 1875/1875 [4:57:30<00:00,  9.52s/it]
[2024-09-05 10:50:08,541] [INFO] [launch.py:347:main] Process 28029 exits successfully.
[2024-09-05 10:50:39,572] [INFO] [launch.py:347:main] Process 28030 exits successfully.
[2024-09-05 10:51:12,605] [INFO] [launch.py:347:main] Process 28031 exits successfully.
[2024-09-05 10:51:43,636] [INFO] [launch.py:347:main] Process 28028 exits successfully.
